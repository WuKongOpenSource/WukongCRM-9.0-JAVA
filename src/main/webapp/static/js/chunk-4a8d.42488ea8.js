(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4a8d","chunk-c94a","chunk-3a5c"],{"+9th":function(e,t,i){"use strict";i.d(t,"k",function(){return s}),i.d(t,"a",function(){return n}),i.d(t,"d",function(){return l}),i.d(t,"e",function(){return o}),i.d(t,"g",function(){return c}),i.d(t,"h",function(){return r}),i.d(t,"b",function(){return d}),i.d(t,"f",function(){return u}),i.d(t,"c",function(){return m}),i.d(t,"j",function(){return h}),i.d(t,"i",function(){return p});var a=i("t3Un");function s(e){return Object(a.a)({url:"task/queryTaskList",method:"post",data:e})}function n(e){return Object(a.a)({url:"task/setTask",method:"post",data:e})}function l(e){return Object(a.a)({url:"task/deleteTask",method:"post",data:e})}function o(e){return Object(a.a)({url:"task/queryTaskInfo",method:"post",data:e})}function c(e){return Object(a.a)({url:"task/setTask",method:"post",data:e})}function r(e){return Object(a.a)({url:"task/svaeTaskRelation",method:"post",data:e})}function d(e){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:e})}function u(e){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:e})}function m(e){return Object(a.a)({url:"taskLabel/deleteLabel",method:"post",data:e})}function h(e){return Object(a.a)({url:"taskLabel/getLabelList",method:"post",data:e})}function p(e){return Object(a.a)({url:"task/queryWorkTaskLog",method:"post",data:e})}},"+NTD":function(e,t,i){"use strict";var a=i("/umX"),s=i.n(a),n=i("mX3o"),l=i("EgJF"),o=i("vG5h"),c=i("6zBA"),r=i("ooHJ"),d=i("7Qib"),u={name:"relative-return-money",components:{CRMCreateView:l.default,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))}},computed:{},mixins:[n.a],data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{}}},watch:{id:function(e){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"期数"},{prop:"customerName",width:"200",label:"客户名称"},{prop:"contractNum",width:"200",label:"合同编号"},{prop:"money",width:"200",label:"计划回款金额"},{prop:"returnDate",width:"200",label:"计划回款日期"},{prop:"returnType",width:"200",label:"计划回款方式"},{prop:"remind",width:"200",label:"提前几日提醒"},{prop:"remark",width:"200",label:"备注"}],this.getPlanList(),this.fieldList=[{prop:"receivablesNum",width:"200",label:"回款编号"},{prop:"contractName",width:"200",label:"合同名称"},{prop:"contractMoney",width:"200",label:"合同金额"},{prop:"receivablesMoney",width:"200",label:"回款金额"},{prop:"num",width:"200",label:"期数"},{prop:"ownerUserName",width:"200",label:"负责人"},{prop:"checkStatus",width:"200",label:"状态"},{prop:"returnTime",width:"200",label:"回款日期"}],this.getList()},methods:s()({getPlanList:function(){var e=this;this.loading=!0,(0,{customer:o.r,contract:c.e}[this.crmType])(this.getParams()).then(function(t){e.loading=!1,e.palnList=t.data}).catch(function(){e.loading=!1})},getList:function(){var e=this;this.loading=!0,(0,{customer:o.q,contract:c.d}[this.crmType])(this.getParams()).then(function(t){e.loading=!1,e.list=t.data}).catch(function(){e.loading=!1})},getParams:function(){return"customer"===this.crmType?{customerId:this.id,pageType:0}:"contract"===this.crmType?{contractId:this.id,pageType:0}:{}},handleRowClick:function(e,t,i){this.showFullId=e.receivablesId,this.showFullCrmType="receivables",this.showFullDetail=!0},cellStyle:function(e){e.row,e.column,e.rowIndex;return 1==e.columnIndex?{color:"#3E84E9"}:""},createClick:function(e){this.createActionInfo={type:"relative",crmType:this.crmType,data:{}},"money"==e?("contract"===this.crmType?(this.createActionInfo.data.customer=Object(d.i)(this.detail),this.createActionInfo.data.contract=Object(d.i)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==e&&("contract"===this.crmType?(this.createActionInfo.data.customer=Object(d.i)(this.detail),this.createActionInfo.data.contract=Object(d.i)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},handleFile:function(e,t){var i=this;"edit"==e?(this.createActionInfo={type:"update",id:t.row.planId},this.createCrmType="receivables_plan",this.isCreate=!0):"delete"==e&&this.$confirm("您确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.c)({planIds:t.row.planId}).then(function(e){i.palnList.splice(t.$index,1),i.$message.success("删除成功")}).catch(function(){})}).catch(function(){i.$message({type:"info",message:"已取消操作"})})},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}}},"cellStyle",function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}})},m=(i("mzCt"),i("ZrdR")),h=Object(m.a)(u,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rc-cont"},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.createClick("plan")}}},[e._v("新建回款计划")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.palnList,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle}},[e._l(e.planFieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("flexbox",{attrs:{justify:"center"}},[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){e.handleFile("edit",t)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){e.handleFile("delete",t)}}},[e._v("删除")])],1)]}}])})],2),e._v(" "),i("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[e.isSeas?e._e():i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.createClick("money")}}},[e._v("新建回款")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle},on:{"row-click":e.handleRowClick}},e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})})),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.showFullCrmType,id:e.showFullId},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":e.createCrmType,action:e.createActionInfo},on:{"save-success":e.saveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"7a371c66",null);h.options.__file="RelativeReturnMoney.vue";t.a=h.exports},"/U9q":function(e,t,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("vG5h"),l=i("UcQx"),o=i("mkuN"),c={name:"relative-contacts",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default,CrmRelative:o.a},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"business"==this.crmType}},mixins:[a.a],data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contactsId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},watch:{id:function(e){this.list=[],this.getDetail()}},props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(e){var t=this;if(e.data.length>0){var i={businessId:this.id};i.contactsIds=e.data.map(function(e){return e.contactsId}).join(","),Object(l.j)(i).then(function(e){t.getDetail(),t.$message.success("操作成功")}).catch(function(){})}},unRelevanceHandleClick:function(){var e=this;0==this.selectionList.length?this.$message.error("请先勾选数据"):this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={businessId:e.id};t.contactsIds=e.selectionList.map(function(e){return e.contactsId}).join(","),Object(l.r)(t).then(function(t){e.getDetail(),e.$message.success("操作成功")}).catch(function(){})}).catch(function(){e.$message.info("已取消操作")})},getFieldList:function(){this.fieldList.push({prop:"name",width:"200",label:"姓名"}),this.fieldList.push({prop:"mobile",width:"200",label:"手机"}),this.fieldList.push({prop:"post",width:"200",label:"职务"})},getDetail:function(){var e=this;this.loading=!0;var t={customer:n.n,business:l.e}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data.list}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},handleRowClick:function(e,t,i){this.contactsId=e.contactsId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"customer"==this.crmType?this.createActionInfo.data.customer=this.detail:"business"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},r=(i("kOyE"),i("ZrdR")),d=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("新建联系人")]),e._v(" "),e.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.unRelevanceHandleClick(t)}}},[e._v("解除关联")]):e._e(),e._v(" "),e.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:e.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:e.customerId}},selectedData:{contacts:e.list},"crm-type":"contacts"},on:{close:function(t){e.showRelativeView=!1},changeCheckout:e.checkRelativeInfos},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}}),e._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(t){e.showRelativeView=!0}},slot:"reference"},[e._v("关联")])],1):e._e()],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle},on:{"row-click":e.handleRowClick,"selection-change":function(t){e.selectionList=t}}},[e.canRelation&&e.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})})],2),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:"contacts",id:e.contactsId},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":"contacts",action:e.createActionInfo},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"7c0304e4",null);d.options.__file="RelativeContacts.vue";t.a=d.exports},"/umX":function(e,t,i){"use strict";t.__esModule=!0;var a=function(e){return e&&e.__esModule?e:{default:e}}(i("9dlP"));t.default=function(e,t,i){return t in e?(0,a.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},"03NE":function(e,t,i){},"1RnH":function(e,t,i){"use strict";var a=i("+9th"),s=i("mkuN"),n=i("Er7M"),l=i("7Qib"),o={components:{CrmRelative:s.a,RelatedBusinessCell:n.a},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},watch:{allData:function(){this.relatedListData=this.allData}},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(e){var t=this;this.showPopover=!1,this.relatedListData=e.data;var i=function(i){var a=e.data[i];t.relevanceAll[i+"Ids"]=a.map(function(e,t,a){return e[i+"Id"]})};for(var a in e.data)i(a);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(e,t,i){var s=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){var i={taskId:s.taskID},n=Object(l.i)(s.relatedListData);n[e].splice(t,1);for(var o=function(e){var t=s.showTypes[e],a=n[t]||[];i[t+"Ids"]=a.map(function(e){return e[t+"Id"]}).join(",")},c=0;c<s.showTypes.length;c++)o(c);Object(a.h)(i).then(function(i){s.relatedListData[e].splice(t,1),s.relatedListData=Object(l.i)(s.relatedListData),s.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){s.$message.info("已取消操作")})},checkRelatedDetail:function(e,t){t.key=t[e+"Id"],this.$emit("checkRelatedDetail",e,t)}}},c=(i("fypj"),i("ZrdR")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"related-business",style:{"margin-left":e.marginLeft}},[!e.isTask&&e.alterable?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showRelative?a("crm-relative",{ref:"crmrelative",attrs:{show:e.showPopover,radio:!1,selectedData:e.relatedListData,showTypes:e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n      关联业务\n    ")])],1):e._e(),e._v(" "),e.alterable?e._e():a("p",{staticClass:"alterable-p",style:{color:e.alterableColor}},[e._v("关联业务")]),e._v(" "),e._l(e.relatedListData,function(t,i){return a("div",{key:i},e._l(t,function(t,s){return a("related-business-cell",{key:s,attrs:{data:t,cellIndex:s,type:i,showFoot:e.isTask},on:{unbind:e.delRelevance,detail:function(a){e.checkRelatedDetail(i,t)}}})}))}),e._v(" "),e.isTask?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showTaskRelative?a("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:e.showPopover,selectedData:e.relatedListData,showTypes:e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showTaskRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n      关联业务\n    ")])],1):e._e()],2)},[],!1,null,"3bca83d2",null);r.options.__file="relatedBusiness.vue";t.a=r.exports},"25U+":function(e,t,i){},"37nJ":function(e,t,i){"use strict";var a=i("25U+");i.n(a).a},"3JdR":function(e,t,i){"use strict";var a=i("pITi");i.n(a).a},"3SNZ":function(e,t,i){},"3gs7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcxMEMyOTg1QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcxMEMyOTg2QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzEwQzI5ODNDMEEzMTFFOEJGNERGRTczODk0MENBOUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzEwQzI5ODRDMEEzMTFFOEJGNERGRTczODk0MENBOUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4G5F1NAAAA5UlEQVR42mJctWpVAwMDQyUQszGQBn4CcRMLkKgC4j9AfJZEA7SBuAZkwEUgNgTiTCA+TaRmJyDeA8SHmIBEERCD6NlAzEKEZj4gng/EH4E4EaTxMBAvB2J9IC4hwoB+IJYD4lQgvs8EFSwD4i9AXAfEKng0+wBxEhDPAOI1DFCng8BTIG4FYk6oJCMWzUJQb4LCrBAmyITmtNtA7AzE8VgMmA7EvEAcAcQ/sBnwE8nkDjTNnUAcBsRZQHwDWYIJTeFWKC2OJl4GpRehO4uJgUIwDAzAlnQ3UWqA/4B7gYEUbwEEGAANECY5RBCuPwAAAABJRU5ErkJggg=="},"4iDY":function(e,t,i){},"5VKn":function(e,t,i){"use strict";var a=i("HfYK");i.n(a).a},"5j45":function(e,t,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("vG5h"),l=i("qbf4"),o=i("mkuN"),c={name:"relative-business",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default,CrmRelative:o.a},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"contacts"==this.crmType}},mixins:[a.a],data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,businessId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},watch:{id:function(e){this.list=[],this.getDetail()}},props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(e){var t=this;if(e.data.length>0){var i={contactsId:this.id};i.businessIds=e.data.map(function(e){return e.businessId}).join(","),Object(l.l)(i).then(function(e){t.getDetail(),t.$message.success("操作成功")}).catch(function(){})}},unRelevanceHandleClick:function(){var e=this;0==this.selectionList.length?this.$message.error("请先勾选数据"):this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={contactsId:e.id};t.businessIds=e.selectionList.map(function(e){return e.businessId}).join(","),Object(l.o)(t).then(function(t){e.getDetail(),e.$message.success("操作成功")}).catch(function(){})}).catch(function(){e.$message.info("已取消操作")})},getFieldList:function(){this.fieldList.push({prop:"businessName",width:"200",label:"商机名称"}),this.fieldList.push({prop:"money",width:"200",label:"商机金额"}),this.fieldList.push({prop:"customerName",width:"200",label:"客户名称"}),this.fieldList.push({prop:"typeName",width:"200",label:"商机状态组"}),this.fieldList.push({prop:"statusName",width:"200",label:"状态"})},getDetail:function(){var e=this;this.loading=!0;var t={contacts:l.g,customer:n.m}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data.list}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},handleRowClick:function(e,t,i){this.businessId=e.businessId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"contacts"==this.crmType?this.createActionInfo.data.customer=this.detail:"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},r=(i("gPG+"),i("ZrdR")),d=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("新建商机")]),e._v(" "),e.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.unRelevanceHandleClick(t)}}},[e._v("解除关联")]):e._e(),e._v(" "),e.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:e.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:e.customerId}},selectedData:{business:e.list},"crm-type":"business"},on:{close:function(t){e.showRelativeView=!1},changeCheckout:e.checkRelativeInfos},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}}),e._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(t){e.showRelativeView=!0}},slot:"reference"},[e._v("关联")])],1):e._e()],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle},on:{"row-click":e.handleRowClick,"selection-change":function(t){e.selectionList=t}}},[e.canRelation&&e.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})})],2),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:"business",id:e.businessId},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":"business",action:e.createActionInfo},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"4273d975",null);d.options.__file="RelativeBusiness.vue";t.a=d.exports},"6MGQ":function(e,t,i){"use strict";var a=i("f0Kh");i.n(a).a},"88LX":function(e,t,i){},"8KPp":function(e,t,i){"use strict";var a=i("rerW"),s=i.n(a),n=i("Qldq"),l=i("Iae0"),o=i("KzkL"),c=(i("7Qib"),{name:"journal-log",components:{JournalCell:l.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},NewDialog:function(){return i.e("chunk-1c91").then(i.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(o.k)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(e){var t=this;if("edit"==e.type){var i=e.data.item;if(this.showNewDialog=!0,this.dialogTitle="编辑日志",this.formData=i,this.imgFileList=[],i.imgList){var a=!0,l=!1,o=void 0;try{for(var c,r=s()(i.imgList);!(a=(c=r.next()).done);a=!0){var d=c.value;d.url=d.filePath,this.imgFileList.push(d)}}catch(e){l=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(l)throw o}}}if(this.accessoryFileList=[],i.fileList){var u=!0,m=!1,h=void 0;try{for(var p,f=s()(i.fileList);!(u=(p=f.next()).done);u=!0){var v=p.value;v.url=v.filePath,this.accessoryFileList.push(v)}}catch(e){m=!0,h=e}finally{try{!u&&f.return&&f.return()}finally{if(m)throw h}}}this.formData.depData=i.sendStructList?i.sendStructList:[],this.formData.sentWhoList=i.sendUserList?i.sendUserList:[]}else"delete"==e.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)({logId:e.data.item.logId}).then(function(i){for(var a in t.$message({type:"success",message:"删除成功!"}),t.list)if(t.list[a].logId==e.data.item.logId){t.list.splice(a,1);break}})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):"related-detail"==e.type&&(this.rowID=e.data.item.key,this.detailCRMType=e.data.type,this.showFullDetail=!0)},submitBtn:function(e,t,i,a){var l=this;this.newLoading=!0;var o=[],c=[],r=[];if(this.formData.depData){var d=!0,u=!1,m=void 0;try{for(var h,p=s()(this.formData.depData);!(d=(h=p.next()).done);d=!0){var f=h.value;r.push(f.id)}}catch(e){u=!0,m=e}finally{try{!d&&p.return&&p.return()}finally{if(u)throw m}}}var v=[];if(this.formData.sentWhoList){var g=!0,b=!1,y=void 0;try{for(var w,C=s()(this.formData.sentWhoList);!(g=(w=C.next()).done);g=!0){var _=w.value;v.push(_.id)}}catch(e){b=!0,y=e}finally{try{!g&&C.return&&C.return()}finally{if(b)throw y}}}var I=!0,T=!1,k=void 0;try{for(var x,D=s()(this.imgFileList);!(I=(x=D.next()).done);I=!0){var L=x.value;o.push(L.fileId)}}catch(e){T=!0,k=e}finally{try{!I&&D.return&&D.return()}finally{if(T)throw k}}var A=!0,N=!1,R=void 0;try{for(var E,S=s()(this.accessoryFileList);!(A=(E=S.next()).done);A=!0){var j=E.value;c.push(j.fileId)}}catch(e){N=!0,R=e}finally{try{!A&&S.return&&S.return()}finally{if(N)throw R}}var O={id:this.formData.logId,categoryId:e,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:c.concat(o),sendUserIds:v,sendStructureIds:r,customerIds:a.customerIds,contactsIds:a.contactsIds,businessIds:a.businessIds,contractIds:a.contractIds};Object(n.c)(O).then(function(e){l.refreshList(),l.showNewDialog=!1,l.$message.success("编辑成功"),l.newLoading=!1}).catch(function(e){l.newLoading=!1,l.$message.error("编辑失败")})}}}),r=(i("jD5e"),i("ZrdR")),d=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("journal-cell",{key:a,staticClass:"list-cell",attrs:{data:t},on:{"on-handle":e.jourecallCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.showNewDialog?i("new-dialog",{attrs:{formData:e.formData,dialogTitle:e.dialogTitle,imgFileList:e.imgFileList,accessoryFileList:e.accessoryFileList,newLoading:e.newLoading},on:{close:function(t){e.showNewDialog=!1},submitBtn:e.submitBtn}}):e._e()],1)},[],!1,null,"909d8092",null);d.options.__file="JournalLog.vue";t.a=d.exports},"9dlP":function(e,t,i){e.exports={default:i("n92x"),__esModule:!0}},BuGm:function(e,t,i){"use strict";i.r(t);var a=i("omC7"),s=i.n(a),n=i("rerW"),l=i.n(n),o=i("Dh/N"),c=(i("KTTK"),i("1RnH")),r=i("0hym"),d=i("7Qib"),u={components:{relatedBusiness:c.a,XhUser:r.a},data:function(){var e=this,t=function(t,i,a){e.formData.startTime&&e.formData.endTime&&Object(d.d)(e.formData.startTime)>=Object(d.d)(e.formData.endTime)&&a(new Error("开始时间必须小于结束时间")),a()};return{zIndex:Object(d.g)(),formList:[{label:"主题",field:"title",type:"color"},{label:"开始时间",field:"startTime",type:"time"},{label:"结束时间",field:"endTime",type:"time"},{label:"参与人",field:"ownerUserIds",type:"participant"},{label:"备注",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"无"},{value:1,label:"准时提醒"},{value:2,label:"5分钟前"},{value:3,label:"15分钟前"},{value:4,label:"30分钟前"},{value:5,label:"一个小时前"},{value:6,label:"二个小时前"},{value:7,label:"一天前"},{value:8,label:"二天前"},{value:9,label:"一周前"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"主题不能为空",trigger:"blur"},{max:50,message:"主题长度最多为50个字符",trigger:"blur"}],startTime:[{required:!0,message:"开始时间不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],endTime:[{required:!0,message:"结束时间不能为空",trigger:"blur"},{validator:t,trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"创建日程"},appendToBody:{type:Boolean,default:!1}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"创建日程"==this.text&&this.$set(this.formData,"color","#3E8EF7")},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(e){this.relevanceAll=e},onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.loading=!0;var i=e.formData,a=[],n=!0,c=!1,r=void 0;try{for(var d,u=l()(e.colleaguesList);!(n=(d=u.next()).done);n=!0){var m=d.value;a.push(m.userId)}}catch(e){c=!0,r=e}finally{try{!n&&u.return&&u.return()}finally{if(c)throw r}}if("创建日程"==e.text)Object(o.a)({title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:e.relevanceAll.customerIds?e.relevanceAll.customerIds.join(","):[],contactsIds:e.relevanceAll.contactsIds?e.relevanceAll.contactsIds.join(","):[],businessIds:e.relevanceAll.businessIds?e.relevanceAll.businessIds.join(","):[],contractIds:e.relevanceAll.contractIds?e.relevanceAll.contractIds.join(","):[]}).then(function(t){1==e.$route.query.routerKey?e.$router.push("schedule"):e.$emit("onSubmit"),e.loading=!1}).catch(function(t){e.loading=!1});else{var h={customerIds:[],contractIds:[],contactsIds:[],businessIds:[]};if(e.allData.customer){var p=!0,f=!1,v=void 0;try{for(var g,b=l()(e.allData.customer);!(p=(g=b.next()).done);p=!0){var y=g.value;h.customerIds.push(y.customerId)}}catch(e){f=!0,v=e}finally{try{!p&&b.return&&b.return()}finally{if(f)throw v}}}if(e.allData.contract){var w=!0,C=!1,_=void 0;try{for(var I,T=l()(e.allData.contract);!(w=(I=T.next()).done);w=!0){var k=I.value;h.contractIds.push(k.contractId)}}catch(e){C=!0,_=e}finally{try{!w&&T.return&&T.return()}finally{if(C)throw _}}}if(e.allData.contacts){var x=!0,D=!1,L=void 0;try{for(var A,N=l()(e.allData.contacts);!(x=(A=N.next()).done);x=!0){var R=A.value;h.contactsIds.push(R.contactsId)}}catch(e){D=!0,L=e}finally{try{!x&&N.return&&N.return()}finally{if(D)throw L}}}if(e.allData.business){var E=!0,S=!1,j=void 0;try{for(var O,M=l()(e.allData.business);!(E=(O=M.next()).done);E=!0){var F=O.value;h.businessIds.push(F.businessId)}}catch(e){S=!0,j=e}finally{try{!E&&M.return&&M.return()}finally{if(S)throw j}}}var B="{}"==s()(e.relevanceAll)?h:e.relevanceAll;Object(o.c)({eventId:i.eventId,title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:B.customerIds.join(","),contactsIds:B.contactsIds.join(","),businessIds:B.businessIds.join(","),contractIds:B.contractIds.join(",")}).then(function(t){e.$emit("onSubmit"),e.loading=!1}).catch(function(t){e.loading=!1})}})},httpRequest:function(e){this.fileList.push(e.file)},onRemove:function(e){for(var t in this.fileList)this.fileList[t].uid==e.uid&&this.fileList.splice(t,1)},changeColor:function(e){this.$set(this.formData,"color",e)},changeCheckout:function(e){this.colleaguesList=e.data},selectDelect:function(e,t){this.$refs.xhuser[0].cancelCheckItem(e),this.colleaguesList.splice(t,1)}},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},m=(i("XRkC"),i("ZrdR")),h=Object(m.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create-schedule",style:{"z-index":e.zIndex}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"add-schedule"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"text"},[e._v(e._s(e.text))]),e._v(" "),a("img",{staticClass:"el-icon-close rt",attrs:{src:i("cjwK"),alt:""},on:{click:e.close}})]),e._v(" "),a("div",{staticClass:"content"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules}},e._l(e.formList,function(t,i){return a("el-form-item",{key:i,class:"el-form-item-"+t.field,style:{width:t.width},attrs:{prop:t.field,label:t.label}},["time"==t.type?[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})]:"textarea"==t.type?[a("el-input",{attrs:{type:"textarea",autosize:{minRows:6},placeholder:"请输入内容"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})]:"participant"==t.type?[a("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",refInFor:!0,attrs:{selectedData:e.colleaguesList},on:{changeCheckout:e.changeCheckout}}),e._v(" "),a("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[e._l(e.colleaguesList,function(t,i){return a("span",{key:i,staticClass:"select-box-span"},[e._v("\n                  "+e._s(t.realname)+"\n                  "),a("span",{staticClass:"el-icon-close",on:{click:function(a){a.stopPropagation(),e.selectDelect(t,i)}}})])}),e._v(" "),a("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==t.type?[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]:"color"==t.type?[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}},[a("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[a("span",{staticClass:"bg-color",style:{background:e.formData.color}})])]),e._v(" "),a("div",{staticClass:"color-box"},e._l(e.colorList,function(t,i){return a("span",{key:i,style:{background:t},on:{click:function(i){e.changeColor(t)}}})}))]:a("el-input",{model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})],2)})),e._v(" "),a("related-business",{attrs:{allData:e.allData},on:{checkInfos:e.checkInfos}})],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.close}},[e._v("取消")])],1)])])},[],!1,null,"7b662842",null);h.options.__file="createSchedule.vue";t.default=h.exports},"DK/9":function(e,t,i){"use strict";var a=i("NT9J");i.n(a).a},"DO/v":function(e,t,i){},DUlf:function(e,t,i){"use strict";var a=i("mX3o"),s=i("eOzp"),n=i("vG5h"),l=i("UcQx"),o=i("6zBA"),c={name:"relative-team",components:{TeamsHandle:s.a},computed:{},mixins:[a.a],data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},watch:{id:function(e){this.list=[],this.getDetail()}},props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"姓名"}),this.fieldList.push({prop:"name",width:"200",label:"职位"}),this.fieldList.push({prop:"groupRole",width:"200",label:"团队角色"}),this.fieldList.push({prop:"power",width:"200",label:"权限"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var e=this;this.loading=!0;var t={customer:n.A,business:l.p,contract:o.l}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){e.loading=!1,e.list=t.data}).catch(function(){e.loading=!1})},handleSelectionChange:function(e){this.selectionList=e},handleClick:function(e){var t=this;"add"==e?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("请勾选需要操作的团队成员"):"edit"==e?this.editPermissionShow=!0:"remove"==e&&this.$confirm("此操作将移除这些团队成员是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t.selectionList.map(function(e,t,i){return e.id}),i={customer:n.y,contract:o.j,business:l.l}[t.crmType],a={ids:t.id,memberIds:e.join(",")};t.loading=!0,i(a).then(function(e){t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleCallBack:function(e){this.getDetail()},handleEditConfirm:function(){var e=this,t=this.selectionList.map(function(e,t,i){return e.id});this.loading=!0,(0,{customer:n.C,business:l.s,contract:o.n}[this.crmType])({ids:this.id,memberIds:t.join(","),power:this.handleType}).then(function(t){e.editPermissionShow=!1,e.$message({type:"success",message:"操作成功"}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})},handleSelectable:function(e,t){return"负责人权限"!=e.power},handleRowClick:function(e,t,i){},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}}}},r=(i("v84z"),i("ZrdR")),d=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rc-cont"},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("remove")}}},[e._v("移除")]),e._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("edit")}}},[e._v("编辑")]),e._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("add")}}},[e._v("添加团队成员")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55",selectable:e.handleSelectable}}),e._v(" "),e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})})],2),e._v(" "),i("teams-handle",{attrs:{crmType:e.crmType,title:"添加团队成员",selectionList:[e.detail],dialogVisible:e.teamsDialogShow},on:{handle:e.handleCallBack,"update:dialogVisible":function(t){e.teamsDialogShow=t}}}),e._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"编辑权限",visible:e.editPermissionShow,"append-to-body":!0,width:"400px"},on:{"update:visible":function(t){e.editPermissionShow=t}}},[i("div",{staticClass:"handle-box"},[i("flexbox",{staticClass:"handle-item"},[i("div",{staticClass:"handle-item-name"},[e._v("权限：")]),e._v(" "),i("el-radio-group",{model:{value:e.handleType,callback:function(t){e.handleType=t},expression:"handleType"}},[i("el-radio",{attrs:{label:1}},[e._v("只读")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("读写")])],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.editPermissionShow=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleEditConfirm(t)}}},[e._v("保存")])],1)])],1)},[],!1,null,"53249d40",null);d.options.__file="RelativeTeam.vue";t.a=d.exports},Dd3h:function(e,t,i){},"Dh/N":function(e,t,i){"use strict";i.d(t,"d",function(){return s}),i.d(t,"a",function(){return n}),i.d(t,"b",function(){return l}),i.d(t,"c",function(){return o});var a=i("t3Un");function s(e){return Object(a.a)({url:"OaEvent/queryList",method:"post",data:e})}function n(e){return Object(a.a)({url:"OaEvent/add",method:"post",data:e})}function l(e){return Object(a.a)({url:"OaEvent/delete",method:"post",data:e})}function o(e){return Object(a.a)({url:"OaEvent/update",method:"post",data:e})}},EjLa:function(e,t,i){},FZ7u:function(e,t,i){},Fpl1:function(e,t,i){"use strict";var a=i("Er7M"),s=i("O1Uw"),n={name:"examine-cell",components:{RelatedBusinessCell:a.a,FileCell:s.a},mixins:[],computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},data:function(){return{}},props:{data:Object},mounted:function(){},methods:{getStatusName:function(e){return 0==e?"待审":1==e?"审核通过":2==e?"审核拒绝":3==e?"审核中":4==e?"撤回":""},getStatusColor:function(e){return 0==e?"#F3A633":1==e?"#93E06D":2==e?"#FF0000":3==e?"#F3A633":4==e?"#FF0000":""},imgZoom:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return{url:e.filePath,name:e.name}})})},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})},checkDetail:function(e){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})}}},l=(i("JHj3"),i("ZrdR")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"list"},[i("div",{staticClass:"list-content"},[i("flexbox",{staticClass:"header"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo head-img"}),e._v(" "),i("div",{staticClass:"name-time"},[i("span",{staticClass:"name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),i("span",{staticClass:"time"},[e._v(e._s(e.data.createtime))])]),e._v(" "),i("div",{staticClass:"rt-setting"},[i("span",{staticClass:"bg-color",style:{"background-color":e.getStatusColor(e.data.examineStatus)}}),e._v(" "),i("span",{staticClass:"dep"},[i("span",[e._v(e._s(e.data.categoryTitle)+" - ")]),e._v(" "),i("span",[e._v(e._s(e.getStatusName(e.data.examineStatus)))])]),e._v(" "),e.data.permission&&(e.data.permission.isChecked||e.data.permission.isUpdate||e.data.permission.isDelete)?i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission&&e.data.permission.isChecked?i("el-dropdown-item",{attrs:{command:"withdraw"}},[e._v("撤回")]):e._e(),e._v(" "),e.data.permission&&e.data.permission.isUpdate?i("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]):e._e(),e._v(" "),e.data.permission&&e.data.permission.isDelete?i("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")]):e._e()],1)],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"row",on:{click:function(t){e.checkDetail(e.data)}}},[e.data.content?i("p",{staticClass:"text"},[e._v(e._s(e.data.content))]):e._e(),e._v(" "),e.data.causeTitle?i("p",{staticClass:"title"},[e._v(e._s(e.data.causeTitle))]):e._e()]),e._v(" "),e.data.file.length>0||e.data.img.length>0?i("div",{staticClass:"accessory"},[i("div",{staticClass:"upload-img-box"},e._l(e.data.img,function(t,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(t){e.imgZoom(e.data.img,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.filePath,expression:"imgItem.filePath"}]})])})),e._v(" "),i("div",{staticClass:"accessory-box"},e._l(e.data.file,function(e,t){return i("file-cell",{key:t,attrs:{data:e,cellIndex:t}})}))]):e._e(),e._v(" "),e.relatedListData.contacts.length>0||e.relatedListData.customer.length>0||e.relatedListData.business.length>0||e.relatedListData.contract.length>0?i("div",{staticClass:"related-business"},[i("div",{staticClass:"label"},[e._v("关联业务")]),e._v(" "),e._l(e.relatedListData,function(t,a){return i("div",{key:a},e._l(t,function(t,s){return i("related-business-cell",{key:s,attrs:{data:t,cellIndex:s,type:a,showFoot:!1},nativeOn:{click:function(i){e.checkRelatedDetail(a,t)}}})}))})],2):e._e()],1)])},[],!1,null,"24fc0b4a",null);o.options.__file="examineCell.vue";t.a=o.exports},HA6S:function(e,t,i){"use strict";var a=i("4iDY");i.n(a).a},HfYK:function(e,t,i){},I0Ad:function(e,t,i){},Iae0:function(e,t,i){"use strict";var a=i("bS4n"),s=i.n(a),n=i("r4mJ"),l=i.n(n),o=i("S3Kq"),c=i("Qldq"),r=i("vPra"),d=i("1RnH"),u=i("8t5x"),m=i("O1Uw"),h={name:"journal-cell",components:{emoji:o.a,relatedBusiness:d.a,FileCell:m.a},mixins:[],computed:s()({},Object(u.b)(["userInfo"]),{allData:function(){var e={};return e.business=this.data.businessList,e.contacts=this.data.contactsList,e.contract=this.data.contractList,e.customer=this.data.customerList,e},allDataShow:function(){return 0!=this.data.businessList.length||0!=this.data.contactsList.length||0!=this.data.contractList.length||0!=this.data.customerList.length}}),watch:{},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1,replyList:[]}},props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},mounted:function(){var e=this;0!=this.data.isRead||this.showWorkbench||(this.$bus.on("journal-list-box-scroll",function(t){e.observePreview(t)}),this.observePreview(document.getElementById("journal-cell"+this.logIndex).parentNode)),this.replyList=this.data.replyList},methods:{observePreview:function(e){var t=this;if(0==this.data.isRead){e&&(this.parentTarget=e);var i=this.whetherPreview();!this.awaitMoment&&i&&(this.awaitMoment=!0,setTimeout(function(){t.awaitMoment=!1,t.whetherPreview()&&t.submiteIsRead()},3e3))}},whetherPreview:function(){var e=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var t=this.parentTarget.getBoundingClientRect().top-e.getBoundingClientRect().top,i=!1;return t<=0&&Math.abs(t)<this.parentTarget.clientHeight?i=!0:t>0&&t<e.clientHeight&&(i=!0),i}return!1},submiteIsRead:function(){var e=this;Object(c.e)({logId:this.showWorkbench?this.data.actionId:this.data.logId}).then(function(t){e.$store.dispatch("GetOAMessageNum","log"),e.data.isRead=1}).catch(function(e){})},getCommentList:function(){var e=this;Object(r.b)({typeId:this.data.logId,type:1}).then(function(t){e.replyList=t.data}).catch(function(){})},verifyAwaitInfo:function(){},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})},checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})},discussDelete:function(e,t,i){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.a)({commentId:e.commentId}).then(function(e){a.$message({type:"success",message:"删除成功!"}),t.splice(i,1),a.$emit("on-handle",{type:"discuss-delete",data:{item:a.data}})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},discussBtn:function(e,t){e.show?(this.$set(e,"show",!1),this.replyChildComment=null):(this.$set(e,"show",!0),this.$set(e,"showComment",!1),this.replyChildComment=e,this.replyChildIndex=t)},childCommentSubmit:function(){var e=this;if(this.replyChildComment&&this.childCommentsTextarea){var t=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];this.contentLoading=!0,Object(r.c)({pid:t.userId,typeId:t.typeId,mainId:0==t.mainId?t.commentId:t.mainId,type:2,content:l()(this.childCommentsTextarea)}).then(function(i){e.childCommentsPopover=!1,i.data.user=e.userInfo,i.data.replyUser=t.user,e.replyChildComment.childCommentList.push(i.data),e.$message.success("回复成功"),e.replyChildComment.show=!1,e.replyChildComment=null,e.contentLoading=!1,e.childCommentsTextarea="",e.$emit("on-handle",{type:"discuss-submit",data:{item:e.data}})}).catch(function(t){e.$message.error("回复失败"),e.contentLoading=!1})}},commentSubmit:function(){var e=this;this.commentsTextarea&&(this.contentLoading=!0,Object(r.c)({typeId:this.showWorkbench?this.data.actionId:this.data.logId,type:2,content:l()(this.commentsTextarea)}).then(function(t){e.$set(e.data,"showComment",!1),t.data.childCommentList=[],t.data.show=!1,t.data.user=e.userInfo,e.replyList.push(t.data),e.commentsTextarea="",e.$message.success("回复成功"),e.contentLoading=!1}).catch(function(t){e.$message.error("回复失败"),e.contentLoading=!1}))},commentBtn:function(e){e.showComment?this.$set(e,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(e,"showComment",!0))},selectEmoji:function(e){var t=this.commentsTextarea.split("");t.splice(this.blurIndex,0,e),this.commentsTextarea=t.join(""),this.commentsPopover=!1},childSelectEmoji:function(e){var t=this.childCommentsTextarea.split("");t.splice(this.blurIndex,0,e),this.childCommentsTextarea=t.join(""),this.childCommentsPopover=!1},blurFun:function(e){this.blurIndex=e.target.selectionEnd},imgZoom:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return{url:e.filePath,name:e.name}})})}},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")}},p=(i("w5xH"),i("ZrdR")),f=Object(p.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list",attrs:{id:"journal-cell"+e.logIndex}},[a("div",{staticClass:"list-content"},[a("div",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],key:e.data.createUser.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("div",{staticClass:"row"},[a("p",{staticClass:"row-title"},[a("span",{staticClass:"name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),e.showWorkbench?a("span",{staticClass:"item-content"},[e._v(e._s(e.data.actionContent))]):a("span",{staticClass:"read",style:{color:0==e.data.isRead?"#3E84E9":"#ccc"}},[e._v(e._s(0==e.data.isRead?"未读":"已读"))])]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(e._f("moment")(e.data.createTime,"YYYY-MM-DD HH:mm")))]),e._v(" "),a("el-tooltip",{attrs:{disabled:!(e.data.sendUserList.length>0||e.data.sendDeptList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"members-dep-title"},[e.data.sendUserList?a("span",e._l(e.data.sendUserList,function(t,i){return a("span",{key:i},[e._v("\n                  "+e._s(0==e.data.sendDeptList.length&&i==e.data.sendUserList.length-1?t.realname:t.realname+"，")+"\n                ")])})):e._e(),e._v(" "),e._l(e.data.sendDeptList,function(t,i){return 0!=e.data.sendDeptList.legnth?a("span",{key:i},[e._v("\n                "+e._s(i==e.data.sendDeptList.length-1?t.name:t.name+"，")+"\n              ")]):e._e()})],2)]),e._v(" "),a("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[e.data.sendDeptList?a("span",[e._v(e._s(e.data.sendDeptList.length)+" 个部门，")]):e._e(),e._v(" "),e.data.sendUserList?a("span",[e._v(e._s(e.data.sendUserList.length)+"个同事")]):e._e()])])],1),e._v(" "),!e.showWorkbench&&e.data.permission&&(e.data.permission.isUpdate||e.data.permission.isDelete)?a("div",{staticClass:"rt-setting"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]):e._e(),e._v(" "),e.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")]):e._e()],1)],1)],1):e._e()]),e._v(" "),a("div",{staticClass:"text"},[e.data.content?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v(e._s(1==e.data.categoryId?"今日工作内容":2==e.data.categoryId?"本周工作内容":"本月工作内容")+"：")]),e._v(e._s(e.data.content))]):e._e(),e._v(" "),e.data.tomorrow?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v(e._s(1==e.data.categoryId?"明日工作内容":2==e.data.categoryId?"下周工作内容":"下月工作内容")+"：")]),e._v(e._s(e.data.tomorrow))]):e._e(),e._v(" "),e.data.question?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v("遇到的问题：")]),e._v(e._s(e.data.question))]):e._e()]),e._v(" "),a("div",{staticClass:"accessory"},[0!=e.data.img.length?a("div",{staticClass:"upload-img-box"},e._l(e.data.img,function(t,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(t){e.imgZoom(e.data.img,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.filePath,expression:"imgItem.filePath"}],key:t.filePath})])})):e._e(),e._v(" "),0!=e.data.file.length?a("div",{staticClass:"accessory-box"},e._l(e.data.file,function(e,t){return a("file-cell",{key:t,attrs:{data:e,cellIndex:t}})})):e._e()]),e._v(" "),e.allDataShow?a("related-business",{attrs:{marginLeft:"0",alterable:!1,allData:e.allData},on:{checkRelatedDetail:e.checkRelatedDetail}}):e._e(),e._v(" "),e.replyList&&0!=e.replyList.length?a("div",{staticClass:"discuss"},[a("div",{staticClass:"border"}),e._v(" "),e._l(e.replyList,function(t,s){return a("div",{key:s,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(t.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:t.user.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("span",{staticClass:"name"},[e._v(e._s(t.user.realname))]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(t.createTime))]),e._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(i){e.discussDelete(t,e.replyList,s)}}},[e._v("删除")]),e._v(" "),a("span",{on:{click:function(i){e.discussBtn(t,-1)}}},[e._v("回复")])]),e._v(" "),a("p",{staticClass:"reply-title"},[a("span",{domProps:{innerHTML:e._s(e.emoji(t.content))}})]),e._v(" "),t.childCommentList&&t.childCommentList.length>0?a("div",{staticClass:"children-reply"},e._l(t.childCommentList,function(i,s){return a("div",{key:s,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:i.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(i.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:i.user.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("span",{staticClass:"name"},[e._v(e._s(i.user.realname))]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(i.createTime))]),e._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(a){e.discussDelete(i,t.childCommentList,s)}}},[e._v("删除")]),e._v(" "),a("span",{on:{click:function(i){e.discussBtn(t,s)}}},[e._v("回复")])]),e._v(" "),a("p",{staticClass:"reply-title"},[[a("span",[e._v("回复")]),e._v(" "),i.replyUser?a("span",{staticClass:"reply"},[e._v("@"+e._s(i.replyUser.realname)+"：")]):e._e()],e._v(" "),a("span",{domProps:{innerHTML:e._s(e.emoji(i.content))}})],2)])})):e._e(),e._v(" "),t.show?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},on:{blur:e.blurFun},model:{value:e.childCommentsTextarea,callback:function(t){e.childCommentsTextarea=t},expression:"childCommentsTextarea"}}),e._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:e.childCommentsPopover,callback:function(t){e.childCommentsPopover=t},expression:"childCommentsPopover"}},[a("emoji",{on:{select:e.childSelectEmoji}}),e._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary",loading:e.contentLoading},on:{click:function(t){e.childCommentSubmit()}}},[e._v("回复")]),e._v(" "),a("el-button",{on:{click:function(e){t.show=!1}}},[e._v("取消")])],1)],1)],1):e._e(),e._v(" "),a("div",{staticClass:"border"})])})],2):e._e()],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-chat-line-round"},on:{click:function(t){e.commentBtn(e.data)}}},[e._v("回复")])],1),e._v(" "),e.data.showComment?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},on:{blur:e.blurFun},model:{value:e.commentsTextarea,callback:function(t){e.commentsTextarea=t},expression:"commentsTextarea"}}),e._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:e.commentsPopover,callback:function(t){e.commentsPopover=t},expression:"commentsPopover"}},[a("emoji",{on:{select:e.selectEmoji}}),e._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary",loading:e.contentLoading},on:{click:function(t){e.commentSubmit()}}},[e._v("回复")]),e._v(" "),a("el-button",{on:{click:function(t){e.data.showComment=!1}}},[e._v("取消")])],1)],1)],1):e._e()])},[],!1,null,"3390bbfc",null);f.options.__file="journalCell.vue";t.a=f.exports},JHj3:function(e,t,i){"use strict";var a=i("t7d2");i.n(a).a},JXju:function(e,t,i){"use strict";var a=i("7Qib"),s=i("mqlf"),n=i("ppJE"),l=i("PS1M"),o=i("n1dw"),c=i("xfX+"),r=i("8gwX"),d=i("K6D0"),u={name:"c-r-m-all-detail",components:{ClueDetail:s.a,CustomerDetail:n.a,ContactsDetail:l.a,BusinessDetail:o.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:d.a},watch:{crmType:function(e){"leads"==this.crmType?this.tabName="clue-detail":"customer"==this.crmType?this.tabName="customer-detail":"contacts"==this.crmType?this.tabName="contacts-detail":"business"==this.crmType?this.tabName="business-detail":"contract"==this.crmType?this.tabName="contract-detail":"product"==this.crmType?this.tabName="product-detail":"receivables"==this.crmType&&(this.tabName="money-detail")}},computed:{},data:function(){return{tabName:""}},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1},listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.style.zIndex=Object(a.g)())},methods:{hiddenView:function(){this.$emit("update:visible",!1)},detailHandle:function(e){this.$emit("handle",e)}},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},m=(i("Xde5"),i("ZrdR")),h=Object(m.a)(u,function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.id&&e.visible?i(e.tabName,{tag:"component",staticClass:"d-view",attrs:{crmType:e.crmType,id:e.id,listenerIDs:e.listenerIDs,noListenerIDs:e.noListenerIDs},on:{handle:e.detailHandle,"hide-view":e.hiddenView}}):e._e()},[],!1,null,"9fe144c6",null);h.options.__file="CRMAllDetail.vue";t.a=h.exports},Jkmh:function(e,t,i){"use strict";var a=i("eknF");i.n(a).a},M8uf:function(e,t,i){},N0PQ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},NG9q:function(e,t,i){"use strict";var a=i("M8uf");i.n(a).a},NS7n:function(e,t,i){"use strict";var a={name:"filterContent",props:{obj:{default:{},required:!0}},watch:{obj:function(e){this.showObj=e}},computed:{},data:function(){return{optionsNames:{is:"等于",isNot:"不等于",contains:"包含",notContains:"不包含",startWith:"开始于",endWith:"结束于",isNull:"为空",isNotNull:"不为空",eq:"等于",neq:"不等于",gt:"大于",egt:"大于等于",lt:"小于",elt:"小于等于"},showObj:{}}},mounted:function(){this.showObj=this.obj},methods:{handleDelete:function(e,t){this.$delete(this.showObj.obj,e.fieldName),this.showObj.form.splice(t,1),this.$emit("delete",{item:e,index:t,obj:this.showObj})},getTypesName:function(e){return e.typeId&&e.typeOption.find(function(t){return t.typeId===e.typeId}).name||""},getCheckName:function(e){var t="";return e.setting.forEach(function(i){i.value!==e.value||(t=i.name)}),t},getStatusName:function(e){if(e.statusId){var t=e.statusOption.find(function(t){return t.statusId===e.statusId});return t.name?"-"+t.name:""}return""}}},s=(i("5VKn"),i("ZrdR")),n=Object(s.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wrapper"},[i("ul",{staticClass:"list"},e._l(e.showObj.form,function(t,a){return i("li",{key:a,staticClass:"list-item"},["date"==t.formType?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"datetime"===t.formType?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"business_type"===t.formType?i("span",[e._v(e._s(t.name+" “"+e.getTypesName(t)+e.getStatusName(t)+"”"))]):"map_address"===t.formType?i("span",[e._v(e._s(t.name+" "+t.address.state+" "+t.address.city+" "+t.address.area))]):"checkStatus"===t.formType?i("span",[e._v(e._s(t.name+" “"+e.optionsNames[t.condition]+"” "+e.getCheckName(t)))]):"user"===t.formType?i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value[0].realname+"”"))]):"category"===t.formType&&t.value.length>0?i("span",[e._v(e._s(t.name+" “"+t.valueContent+"”"))]):i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value+"”"))]),e._v(" "),i("i",{staticClass:"el-icon-close icon",on:{click:function(i){e.handleDelete(t,a)}}})])}))])},[],!1,null,"614d61c7",null);n.options.__file="filterContent.vue";t.a=n.exports},NT9J:function(e,t,i){},NfgT:function(e,t,i){},O1Uw:function(e,t,i){"use strict";var a=i("7Qib"),s=i("KTTK"),n={name:"file-cell",computed:{},watch:{},data:function(){return{}},props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},mounted:function(){},methods:{downloadClick:function(){Object(a.a)({path:this.data.filePath,name:this.data.name})},deleteClick:function(){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.c)({id:e.data.fileId}).then(function(t){e.$message.success("操作成功"),e.$emit("delete",e.cellIndex,e.data)}).catch(function(){})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}},beforeDestroy:function(){}},l=(i("ng0A"),i("ZrdR")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE"),alt:""}}),e._v(" "),a("div",{staticClass:"cell-body",class:{"cursor-pointer":e.cursorPointer}},[a("span",[e._v(e._s(e.data.name.length>20?e.data.name.substring(0,20)+"...":e.data.name))]),e._v(" "),a("span",{staticClass:"size"},[e._v("("+e._s(e.data.size)+")")])]),e._v(" "),a("div",{staticClass:"cell-foot"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downloadClick}},[e._v("下载")]),e._v(" "),e.showDelete?a("i",{staticClass:"el-icon-delete",on:{click:e.deleteClick}}):e._e()],1)])},[],!1,null,"70405680",null);o.options.__file="index.vue";t.a=o.exports},OPCT:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},ObfC:function(e,t,i){},Op00:function(e,t,i){"use strict";var a=i("+9th"),s={name:"task-cell",components:{},mixins:[],computed:{},watch:{},data:function(){return{}},props:{data:Object,dataIndex:Number},mounted:function(){},methods:{taskOverClick:function(e){var t=this;Object(a.g)({taskId:e.taskId,status:e.checked?5:1}).then(function(e){t.$store.dispatch("GetOAMessageNum","task")}).catch(function(t){e.checked=!1})},rowFun:function(e){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(e){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(e,"show",!0):this.$set(e,"show",!1)}}},n=(i("NG9q"),i("ZrdR")),l=Object(n.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==e.data.priority?"#8bb5f0":2==e.data.priority?"#FF9668":3==e.data.priority?"#ED6363":"transparent"},on:{click:function(t){e.rowFun(e.data)}}},[i("div",{ref:"listLeft",staticClass:"list-left"},[i("div",{class:e.data.checked?"title title-active":"title",on:{click:function(e){e.stopPropagation()}}},[i("el-checkbox",{on:{change:function(t){e.taskOverClick(e.data)}},model:{value:e.data.checked,callback:function(t){e.$set(e.data,"checked",t)},expression:"data.checked"}})],1),e._v(" "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[e._v(e._s(e.data.name))])]),e._v(" "),i("span",{ref:"itemSpan",class:e.data.checked?"item-name-active":"item-name"},[e._v("\n        "+e._s(e.data.name)+"\n      ")])])],1),e._v(" "),i("div",{staticClass:"list-right"},[e.data.labelList&&e.data.labelList.length>0?i("div",{staticClass:"tag-box"},[e.data.labelList.length<=2?e._l(e.data.labelList,function(t,a){return i("div",{key:a,staticClass:"item-label"},[i("span",{staticClass:"k-name",style:{background:t.color}},[e._v(e._s(t.labelName))])])}):[i("span",{staticClass:"k-name",style:{background:e.data.labelList[0].color}},[e._v(e._s(e.data.labelList[0].labelName))]),e._v(" "),i("span",{staticClass:"k-name",style:{background:e.data.labelList[1].color}},[e._v(e._s(e.data.labelList[1].labelName))]),e._v(" "),i("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[i("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},e._l(e.data.labelList,function(t,a){return i("div",{key:a,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[a>=2?i("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:t.color||"#ccc"}},[e._v(e._s(t.labelName))]):e._e()])})),e._v(" "),i("span",{staticClass:"color-label-more"},[i("i",[e._v("...")])])])]],2):e._e(),e._v(" "),i("div",{staticClass:"img-group"},[e.data.relationCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-relevance"}),e._v(" "),i("span",[e._v(e._s(e.data.relationCount))])]):e._e(),e._v(" "),e.data.childAllCount>0?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-sub-task"}),e._v(" "),i("span",[e._v(e._s(e.data.childWCCount)+"/"+e._s(e.data.childAllCount))])]):e._e(),e._v(" "),e.data.fileCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-file"}),e._v(" "),i("span",[e._v(e._s(e.data.fileCount))])]):e._e(),e._v(" "),e.data.commentCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-comment-task"}),e._v(" "),i("span",[e._v(e._s(e.data.commentCount))])]):e._e(),e._v(" "),e.data.stopTime?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-time-task",style:{color:1!=e.data.isEnd||e.data.checked?"#999":"red"}}),e._v(" "),i("span",{style:{color:1!=e.data.isEnd||e.data.checked?"#999":"red"}},[e._v(e._s(e._f("moment")(e.data.stopTime,"MM-DD"))+" 截止")])]):e._e()]),e._v(" "),i("div",{staticClass:"item-own-box"},[e.data.mainUser&&e.data.mainUser.id?i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[e._v(e._s(e.data.mainUser.realname))])]),e._v(" "),i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.mainUser,expression:"data.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.mainUser.img),expression:"$options.filters.filterUserLazyImg(data.mainUser.img)",arg:"background-image"}],staticClass:"div-photo"})]):e._e()],1)])])},[],!1,null,"eb04289c",null);l.options.__file="taskCell.vue";t.a=l.exports},Q98W:function(e,t,i){},QJC7:function(e,t,i){"use strict";var a=i("7Qib"),s=i("KzkL"),n={name:"follow-record-cell",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-fbe8"),i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-c94a"),i.e("chunk-7b3a1")]).then(i.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return e.url=e.filePath,e})})},downloadFile:function(e){Object(a.a)({path:e.filePath,name:e.name})},handleCommand:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.m)({recordId:t.item.recordId}).then(function(i){t.$emit("on-handle",{type:e,data:{item:t.item,index:t.index}}),t.$message.success("操作成功")}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},checkRelationDetail:function(e,t){this.relationID=t,this.relationCrmType=e,this.showFullDetail=!0}}},l=(i("gyJD"),i("ZrdR")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:{img:e.item.userImg,realname:e.item.realname},expression:"{img: item.userImg, realname: item.realname}"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.item.userImg),expression:"$options.filters.filterUserLazyImg(item.userImg)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),e._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[e._v(e._s(e.item.realname))]),e._v(" "),a("div",{staticClass:"fl-h-time"},[e._v(e._s(e.item.createTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-h-mark"},[a("img",{staticClass:"fl-h-mark-img",attrs:{src:i("N0PQ")}}),e._v(" "),a("div",{staticClass:"fl-h-mark-name"},[e._v("跟进记录")])]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")])],1)],1)],1),e._v(" "),a("div",{staticClass:"fl-b"},[a("div",{staticClass:"fl-b-content"},[e._v(e._s(e.item.content))]),e._v(" "),e.item.img&&e.item.img.length>0?a("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},e._l(e.item.img,function(t,i){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.filePath,expression:"file.filePath",arg:"background-image"}],key:t.filePath,staticClass:"fl-b-img-item",on:{click:function(t){e.previewImg(e.item.img,i)}}})})):e._e(),e._v(" "),e.item.file&&e.item.file.length>0?a("div",{staticClass:"fl-b-files"},e._l(e.item.file,function(t,s){return a("flexbox",{key:s,staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE")}}),e._v(" "),a("div",{staticClass:"cell-body"},[e._v(e._s(t.name)),a("span",{staticStyle:{color:"#ccc"}},[e._v("（"+e._s(t.size)+"）")])]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(i){e.downloadFile(t)}}},[e._v("下载")])],1)})):e._e(),e._v(" "),e.item.category||e.item.nextTime?a("div",{staticClass:"follow"},[e.item.category?a("span",{staticClass:"follow-info"},[e._v(e._s(e.item.category))]):e._e(),e._v(" "),e.item.nextTime?a("span",{staticClass:"follow-info"},[e._v(e._s(e.item.nextTime))]):e._e()]):e._e(),e._v(" "),e.item.contactsList&&e.item.contactsList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[e._v("关联联系人")]),e._v(" "),a("div",e._l(e.item.contactsList,function(t,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("contacts",t.contactsId)}}},[a("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.name))])])}))]):e._e(),e._v(" "),e.item.businessList&&e.item.businessList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[e._v("关联商机")]),e._v(" "),a("div",e._l(e.item.businessList,function(t,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("business",t.businessId)}}},[a("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.businessName))])])}))]):e._e()],1),e._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.relationCrmType,id:e.relationID},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"495ceed6",null);o.options.__file="FollowRecordCell.vue";var c=o.exports,r=i("5tgW"),d=i("vG5h"),u=i("qbf4"),m=i("UcQx"),h=i("6zBA"),p={name:"record-log",components:{FollowRecordCell:c},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var e=this;this.$bus.on("follow-log-refresh",function(t){"record-log"==t.type&&e.refreshList()});var t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={customer:d.u,leads:r.i,contacts:u.j,business:m.h,contract:h.g}[this.crmType],i={page:this.page,limit:10};i[this.crmType+"Id"]=this.id,t(i).then(function(t){e.list=e.list.concat(t.data),t.data.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(e){"delete"==e.type&&this.list.splice(e.data.index,1)}},beforeDestroy:function(){this.$bus.off("follow-log-refresh")}},f=(i("DK/9"),Object(l.a)(p,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("follow-record-cell",{key:a,attrs:{item:t,index:a,crmType:e.crmType},on:{"on-handle":e.cellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"540163b3",null));f.options.__file="RecordLog.vue";t.a=f.exports},QWvp:function(e,t,i){"use strict";var a=i("NfgT");i.n(a).a},Qldq:function(e,t,i){"use strict";i.d(t,"d",function(){return s}),i.d(t,"a",function(){return n}),i.d(t,"c",function(){return l}),i.d(t,"b",function(){return o}),i.d(t,"e",function(){return c});var a=i("t3Un");function s(e){return Object(a.a)({url:"OaLog/queryList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function n(e){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function l(e){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function o(e){return Object(a.a)({url:"OaLog/deleteById",method:"post",data:e})}function c(e){return Object(a.a)({url:"OaLog/readLog",method:"post",data:e})}},S3Kq:function(e,t,i){"use strict";var a=i("EPZ6"),s=i.n(a),n=i("sCIN"),l={name:"emoji",data:function(){return{emojiData:n.a,pannels:["表情","自然","物品","地点","符号"],activeIndex:0}},created:function(){},methods:{changeActive:function(e){this.activeIndex=e},getPureName:function(e){return e.replace(/:/g,"")},selectItem:function(e){this.$emit("select",e)}},computed:{emojis:function(){var e=this;return this.pannels.map(function(t){return s()(e.emojiData[t])})}}},o=(i("Jkmh"),i("ZrdR")),c=Object(o.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"emoji"},[i("ul",{staticClass:"emoji-controller"},e._l(e.pannels,function(t,a){return i("li",{key:a,class:{active:a===e.activeIndex},on:{click:function(t){e.changeActive(a)}}},[e._v("\n      "+e._s(t)+"\n    ")])})),e._v(" "),i("ul",{staticClass:"emoji-container"},e._l(e.emojis,function(t,a){return a===e.activeIndex?i("li",{key:a,staticStyle:{padding:"0"}},[e._v("\n      "+e._s(t)+"--"+e._s(a)+"\n      "),e._l(t,function(t,a){return i("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(i){e.selectItem(t)}}},[i("span",{staticClass:"emoji-item",class:"sprite-"+e.getPureName(t),attrs:{title:t}})])})],2):e._e()}))])},[],!1,null,"f42c84dc",null);c.options.__file="emoji.vue";t.a=c.exports},S3eq:function(e,t,i){"use strict";var a=i("ozG6");i.n(a).a},TOIK:function(e,t,i){},TU2G:function(e,t,i){},Tc2t:function(e,t,i){"use strict";var a=i("Dd3h");i.n(a).a},UEWd:function(e,t,i){"use strict";var a=i("7Qib"),s=i("KTTK"),n={name:"mix-add",components:{CrmRelative:i("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:i("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:i("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:"",batchId:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:i("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:i("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts,batchId:this.batchId})})},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType="",this.batchId=""},checkRelativeInfos:function(e){"business"==this.showRelativeType?this.business=e.data:"contacts"==this.showRelativeType&&(this.contacts=e.data)},barClick:function(e){"business"==e.type?(this.showRelativeType=e.type,e.show=!0):"contacts"==e.type&&(this.showRelativeType=e.type,e.show=!0)},uploadFile:function(e){var t=this,i=e.target.files;if(i.length){var a="image/*"==e.target.accept?"img":"file",s=i[0];this.sendFileRequest(s,a,function(){for(var s=1;s<i.length;s++){var n=i[s];t.sendFileRequest(n,a)}e.target.value=""})}},sendFileRequest:function(e,t,i){var n=this,l={file:e,type:t};this.batchId&&(l.batchId=this.batchId),Object(s.e)(l).then(function(s){""==n.batchId&&(n.batchId=s.batchId),s.size=Object(a.c)(e.size),"img"==t?n.imgFiles.push(s):(s.icon=Object(a.f)(e),n.files.push(s)),i&&i()}).catch(function(){})},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(e,t,i){var a=this;Object(s.c)({id:t.fileId}).then(function(t){"image"==e?a.imgFiles.splice(i,1):a.files.splice(i,1),a.$message.success("操作成功")}).catch(function(){})},mouseImgOver:function(e,t){e.showDelete=!0,this.$set(this.imgFiles,t,e)},mouseImgLeave:function(e,t){e.showDelete=!1,this.$set(this.imgFiles,t,e)},inputFocus:function(){var e=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){e.$refs.textarea.resizeTextarea()})}},beforeDestroy:function(){this.$off("submit-info")}},l=(i("37nJ"),i("ZrdR")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mix-container"},[a("div",{staticClass:"i-cont"},[a("el-input",{ref:"textarea",attrs:{type:"textarea",autosize:e.inputAutosize,clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:e.inputFocus},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),e._v(" "),e.imgFiles.length>0?a("section",{staticClass:"img-cont"},[a("flexbox",{attrs:{wrap:"wrap"}},[e._l(e.imgFiles,function(t,i){return a("div",{key:i,staticClass:"img-item",style:{"background-image":"url("+t.url+")"},on:{mouseover:function(a){e.mouseImgOver(t,i)},mouseleave:function(a){e.mouseImgLeave(t,i)}}},[t.showDelete?a("div",{staticClass:"img-delete",on:{click:function(a){e.deleteImgOrFile("image",t,i)}}},[e._v("×")]):e._e()])}),e._v(" "),a("div",{staticClass:"img-item-add"},[a("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:e.uploadFile}})])],2),e._v(" "),a("div",{staticClass:"img-bar",on:{click:e.deleteAllImg}},[e._v("全部删除")])],1):e._e(),e._v(" "),e.files.length>0?a("section",{staticClass:"file-cont"},[a("flexbox",{staticClass:"f-header"},[a("img",{staticClass:"f-logo",attrs:{src:i("rl4O")}}),e._v(" "),a("div",{staticClass:"f-name"},[e._v("附件")])]),e._v(" "),a("div",{staticClass:"f-body"},e._l(e.files,function(t,i){return a("flexbox",{key:i,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:t.icon}}),e._v(" "),a("div",{staticClass:"f-name"},[e._v(e._s(t.name+"("+t.size+")"))]),e._v(" "),a("div",{staticClass:"close-button",on:{click:function(a){e.deleteImgOrFile("file",t,i)}}},[e._v("×")])])})),e._v(" "),a("div",{staticClass:"img-bar",on:{click:function(t){e.files=[]}}},[e._v("全部删除")])],1):e._e(),e._v(" "),e.business.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("i91G")}}),e._v(" "),a("div",{staticClass:"c-name"},[e._v("商机")])]),e._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},e._l(e.business,function(t,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[e._v(e._s(t.businessName))]),e._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(t){e.business.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),e.contacts.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("OPCT")}}),e._v(" "),a("div",{staticClass:"c-name"},[e._v("联系人")])]),e._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},e._l(e.contacts,function(t,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(t){e.contacts.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),a("flexbox",{staticClass:"bar-cont"},[e._l(e.barItems,function(t,i){return["img"==t.type||"file"==t.type?a("flexbox",{key:i,staticClass:"bar-item",nativeOn:{click:function(i){e.barClick(t)}}},[a("input",{staticClass:"bar-input",attrs:{type:"file",accept:t.data,multiple:""},on:{change:e.uploadFile}}),e._v(" "),a("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])]):a("el-popover",{key:i,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.show,callback:function(i){e.$set(t,"show",i)},expression:"item.show"}},[a("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:t.show,radio:!1,action:{type:"condition",data:{moduleType:e.crmType,customerId:e.id}},selectedData:"business"==t.type?{business:e.business}:{contacts:e.contacts},"crm-type":t.type},on:{close:function(e){t.show=!1},changeCheckout:e.checkRelativeInfos}}),e._v(" "),a("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(i){e.barClick(t)}},slot:"reference"},[a("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])])],1)]})],2)],1)},[],!1,null,"4046b7aa",null);o.options.__file="MixAdd.vue";t.a=o.exports},WTqp:function(e,t,i){"use strict";var a=i("ObfC");i.n(a).a},"Wz/f":function(e,t,i){},XRkC:function(e,t,i){"use strict";var a=i("EjLa");i.n(a).a},Xde5:function(e,t,i){"use strict";var a=i("I0Ad");i.n(a).a},ZSBr:function(e,t,i){},"aQg/":function(e,t,i){"use strict";var a=i("d0bK"),s=i("Op00"),n=i("KzkL"),l=i("7Qib"),o={name:"task-log",components:{TaskCell:s.a,Particulars:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-28ac")]).then(i.bind(null,"+Gvz"))}},props:{id:[String,Number],crmType:{type:String,default:""}},mixins:[a.a],watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(n.l)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(e){var t=this;"view"==e.type&&this.showDetailView(e.data.item,e.data.index,function(){t.$nextTick(function(){document.body.appendChild(t.$refs.taskShade),t.$refs.taskShade.style.zIndex=Object(l.g)(),t.$refs.taskShade.addEventListener("click",t.handleDocumentClick,!1)})})},handleDocumentClick:function(e){e.stopPropagation(),this.$refs.taskShade==e.target&&(this.taskDetailShow=!1)}}},c=(i("hNda"),i("ZrdR")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("task-cell",{key:a,attrs:{data:t,dataIndex:a},on:{"on-handle":e.taskCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),e._v(" "),e.taskDetailShow?i("div",{ref:"taskShade",staticClass:"full-container"},[i("particulars",{staticClass:"d-view",attrs:{id:e.taskID,detailIndex:e.detailIndex},on:{"on-handle":e.detailHandle,close:e.closeBtn}})],1):e._e()])},[],!1,null,"7de56332",null);r.options.__file="TaskLog.vue";t.a=r.exports},cHfS:function(e,t,i){var a=i("ovlw");a(a.S+a.F*!i("8wne"),"Object",{defineProperty:i("cP0M").f})},cYid:function(e,t,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("vG5h"),l=i("UcQx"),o={name:"relative-contract",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default},computed:{},mixins:[a.a],data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contractId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},watch:{id:function(e){this.list=[],this.getDetail()}},props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"num",width:"200",label:"合同编号"}),this.fieldList.push({prop:"contractName",width:"200",label:"合同名称"}),this.fieldList.push({prop:"customerName",width:"200",label:"客户名称"}),this.fieldList.push({prop:"money",width:"200",label:"合同金额"}),this.fieldList.push({prop:"startTime",width:"200",label:"开始日期"}),this.fieldList.push({prop:"endTime",width:"200",label:"结束日期"})},getDetail:function(){var e=this;this.loading=!0;var t={customer:n.o,business:l.f}[this.crmType],i={pageType:0};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},handleRowClick:function(e,t,i){this.contractId=e.contractId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"business"==this.crmType?(this.createActionInfo.data.customer=this.detail,this.createActionInfo.data.business=this.detail):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.getDetail()}}},c=(i("njVd"),i("ZrdR")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("新建合同\n    ")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,stripe:"","header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle},on:{"row-click":e.handleRowClick}},e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label}})})),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:"contract",id:e.contractId},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":"contract",action:e.createActionInfo},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"28359f5d",null);r.options.__file="RelativeContract.vue";t.a=r.exports},d0bK:function(e,t,i){"use strict";t.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(e,t,i){this.taskID=e.taskId,this.detailIndex=t,this.taskDetailShow=!0,i&&i()},detailHandle:function(e){if(0==e.index||e.index)if("title-check"==e.type)this.$set(this.list[e.index],"checked",e.value);else if("delete"==e.type)this.list.splice(e.index,1);else if("change-stop-time"==e.type){new Date(e.value).getTime()/1e3+86399>new Date(new Date).getTime()/1e3?this.list[e.index].isEnd=!1:this.list[e.index].isEnd=!0,this.list[e.index].stopTime=e.value}else if("change-priority"==e.type)this.list[e.index].priority=e.value.id;else if("change-name"==e.type)this.list[e.index].name=e.value;else if("change-comments"==e.type){var t=this.list[e.index].commentCount;"add"==e.value?this.list[e.index].commentCount=t+1:this.list[e.index].commentCount=t-1}else"change-sub-task"==e.type&&(this.list[e.index].childWCCount=e.value.subdonecount,this.list[e.index].childAllCount=e.value.allcount)}},deactivated:function(){}}},eknF:function(e,t,i){},f0Kh:function(e,t,i){},fypj:function(e,t,i){"use strict";var a=i("Q98W");i.n(a).a},"gPG+":function(e,t,i){"use strict";var a=i("TU2G");i.n(a).a},gd5k:function(e,t,i){"use strict";var a=i("Fpl1"),s=i("+zsY"),n=i("KzkL"),l=i("ExMk"),o=(i("7Qib"),{name:"examine-log",components:{ExamineCell:a.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},ExamineHandle:function(){return i.e("chunk-0c4f").then(i.bind(null,"QhmF"))},ExamineCreateView:s.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(n.j)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(e){var t=this;"edit"==e.type?(e.data.item.title=e.data.item.categoryName,this.createInfo=e.data.item,this.createAction={type:"update",id:e.data.item.examineId,data:e.data.item},this.isCreate=!0):"delete"==e.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.d)({examineId:e.data.item.examineId}).then(function(e){t.refreshList(),t.$message({type:"success",message:"删除成功!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):"withdraw"==e.type?(this.rowID=e.data.item.examineId,this.showExamineHandle=!0):"view"==e.type?(this.detailCRMType="examine",this.rowID=e.data.item.examineId,this.showFullDetail=!0):"related-detail"==e.type&&(this.rowID=e.data.item[e.data.type+"Id"],this.detailCRMType=e.data.type,this.showFullDetail=!0)}}}),c=(i("Tc2t"),i("ZrdR")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("examine-cell",{key:a,attrs:{data:t},on:{"on-handle":e.examineCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),e._v(" "),i("examine-handle",{attrs:{show:e.showExamineHandle,id:e.rowID,examineType:"oa_examine",status:"2"},on:{close:function(t){e.showExamineHandle=!1},save:e.refreshList}}),e._v(" "),e.isCreate?i("examine-create-view",{attrs:{categoryId:e.createInfo.categoryId,categoryTitle:e.createInfo.title,type:e.createInfo.type,action:e.createAction},on:{"save-success":e.refreshList,"hiden-view":function(t){e.isCreate=!1}}}):e._e(),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"aea2f058",null);r.options.__file="ExamineLog.vue";t.a=r.exports},gyJD:function(e,t,i){"use strict";var a=i("3SNZ");i.n(a).a},hNda:function(e,t,i){"use strict";var a=i("ZSBr");i.n(a).a},i68b:function(e,t,i){"use strict";var a=i("KzkL");t.a={data:function(){return{followTypes:[],followType:""}},created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var e=this;this.loading=!0,Object(a.u)().then(function(t){e.loading=!1,e.followTypes=t.data.map(function(e){return{type:e,name:e}}),e.followType=t.data.length>0?t.data[0]:""}).catch(function(){e.loading=!1})}},deactivated:function(){}}},i91G:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},jD5e:function(e,t,i){"use strict";var a=i("DO/v");i.n(a).a},kOyE:function(e,t,i){"use strict";var a=i("Wz/f");i.n(a).a},l0L9:function(e,t,i){},lY9l:function(e,t,i){},mzCt:function(e,t,i){"use strict";var a=i("lY9l");i.n(a).a},n92x:function(e,t,i){i("cHfS");var a=i("rhgp").Object;e.exports=function(e,t,i){return a.defineProperty(e,t,i)}},ng0A:function(e,t,i){"use strict";var a=i("l0L9");i.n(a).a},njVd:function(e,t,i){"use strict";var a=i("FZ7u");i.n(a).a},oWS4:function(e,t,i){"use strict";var a=i("7Qib"),s=i("8GhS"),n=i("0rRK"),l=i.n(n),o={name:"index",components:{XhUserCell:s.p,XhProuctCate:s.j,VDistpicker:l.a},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:[]},obj:{default:{},required:!0},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{form:[],visible:!1,showErrors:!1,saveChecked:!1,saveDefault:!1,saveName:null}},watch:{dialogVisible:{handler:function(e){e&&(this.form=Object(a.i)(this.obj.form),0==this.form.length&&this.form.push({fieldName:"",name:"",formType:"",condition:"is",value:"",typeOption:[],statusOption:[],typeId:"",statusId:"",address:{state:"",city:"",area:""}}),this.saveChecked=!1,this.saveDefault=!1,this.saveName=null),this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick(function(){var e=document.getElementById("filter-container");e.scrollTop=e.scrollHeight})}},methods:{selectProvince:function(e,t){t.address.state=e.value},selectCity:function(e,t){t.address.city=e.value},selectArea:function(e,t){t.address.area=e.value},typeOptionsChange:function(e){if(e.typeId){var t=e.typeOption.find(function(t){return t.typeId===e.typeId});e.statusOption=t.statusList||[]}else e.statusOption=[];e.statusId=""},arrayValueChange:function(e){e.value.length>0?(e.item.value=e.value,e.item.valueContent=e.valueContent):e.item.value=[]},showCalCondition:function(e){return"date"!=e&&"datetime"!=e&&"business_type"!=e&&"category"!=e&&"map_address"!=e},calConditionOptions:function(e,t){return"select"==e||"checkbox"==e||"user"==e||"checkStatus"==e?[{value:"is",label:"等于",disabled:!1},{value:"isNot",label:"不等于",disabled:!1}]:"module"==e||"text"==e||"textarea"==e?[{value:"is",label:"等于",disabled:!1},{value:"isNot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"notContains",label:"不包含",disabled:!1}]:"floatnumber"==e||"number"==e?[{value:"is",label:"等于",disabled:!1},{value:"isNot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"notContains",label:"不包含",disabled:!1},{value:"isNull",label:"为空",disabled:!1},{value:"isNotNull",label:"不为空",disabled:!1},{value:"gt",label:"大于",disabled:!1},{value:"egt",label:"大于等于",disabled:!1},{value:"lt",label:"小于",disabled:!1},{value:"elt",label:"小于等于",disabled:!1}]:"category"==e?[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"not_contain",label:"不包含",disabled:!1}]:[{value:"is",label:"等于",disabled:!1},{value:"isNot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"notContains",label:"不包含",disabled:!1},{value:"startWith",label:"开始于",disabled:!1},{value:"endWith",label:"结束于",disabled:!1},{value:"isNull",label:"为空",disabled:!1},{value:"isNotNull",label:"不为空",disabled:!1},{value:"gt",label:"大于",disabled:!1},{value:"egt",label:"大于等于",disabled:!1},{value:"lt",label:"小于",disabled:!1},{value:"elt",label:"小于等于",disabled:!1}]},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.fieldName===e.fieldName});t&&(e.formType=t.formType,e.name=t.name,"business_type"==e.formType?(e.typeOption=t.setting,e.statusOption=[],e.typeId="",e.statusId="",e.value=""):"select"==e.formType||"checkStatus"==e.formType?(e.setting=t.setting||[],e.value=""):"map_address"==e.formType?e.address={state:"",city:"",area:""}:"date"===e.formType||"datetime"===e.formType||"user"===e.formType||"category"===e.formType?e.value=[]:e.value=""),this.form.filter(function(t){return t.fieldName===e.fieldName}).length>1?this.showErrors=!0:this.showErrors=!1},handleCancel:function(){this.$emit("update:dialogVisible",!1)},handleConfirm:function(){if(this.showErrors)this.$message.error("筛选条件中有重复项！");else if(!this.saveChecked||this.saveName&&""!==this.saveName){for(var e=0;e<this.form.length;e++){var t=this.form[e];if(!t.fieldName||""===t.fieldName)return void this.$message.error("要筛选的字段名称不能为空！");if("business_type"==t.formType){if(!t.typeId&&!t.statusId)return void this.$message.error("请输入筛选条件的值！")}else if("map_address"==t.formType){if(!t.address.state&&!t.address.city&&!t.address.area)return void this.$message.error("请选择筛选条件的值！")}else if("date"==t.formType||"datetime"==t.formType||"user"==t.formType||"category"==t.formType){if(!t.value||0===t.value.length)return void this.$message.error("请选择筛选条件的值！")}else if(!t.value&&0!==t.value)return void this.$message.error("请输入筛选条件的值！")}var i={};this.form.forEach(function(e){if("datetime"==e.formType||"date"==e.formType)i[e.fieldName]={start:e.value[0],end:e.value[1],formType:e.formType,name:e.fieldName};else if("business_type"==e.formType)i[e.fieldName]={typeId:e.typeId,statusId:e.statusId,formType:e.formType,name:e.fieldName};else if("user"==e.formType)i[e.fieldName]={condition:e.condition,value:e.value[0].userId,formType:e.formType,name:e.fieldName};else if("category"==e.formType)i[e.fieldName]={condition:"is",value:e.value[e.value.length-1],formType:e.formType,name:e.fieldName};else if("map_address"==e.formType){var t="";for(var a in e.address)e.address[a]&&(t+=e.address[a]+",");i[e.fieldName]={value:t,formType:e.formType,name:e.fieldName}}else i[e.fieldName]={condition:e.condition,value:e.value,formType:e.formType,name:e.fieldName}});var a={obj:i,form:this.form,saveChecked:this.saveChecked,saveDefault:this.saveDefault,saveName:this.saveName};this.$emit("filter",a)}else this.$message.error("场景名称不能为空！")},handleAdd:function(){this.form.push({fieldName:"",condition:"is",value:"",formType:"",setting:[],typeOption:[],statusOption:[],typeId:"",statusId:""})},handleDelete:function(e){var t=this;this.$confirm("您确定要删除这一条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.form.splice(e,1)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},c=(i("tpVs"),i("ZrdR")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"高级筛选",visible:e.visible,width:"900px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v("筛选条件")]),e._v(" "),i("el-form",{staticClass:"filter-container",attrs:{id:"filter-container"}},[i("el-form-item",[e._l(e.form,function(t,a){return[i("el-row",{key:a},[i("el-col",{attrs:{span:8}},[i("el-select",{attrs:{placeholder:"请选择要筛选的字段名"},on:{change:function(i){e.fieldChange(t)}},model:{value:t.fieldName,callback:function(i){e.$set(t,"fieldName",i)},expression:"formItem.fieldName"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.fieldName,attrs:{label:e.name,value:e.fieldName}})}))],1),e._v(" "),e.showCalCondition(t.formType)?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),e.showCalCondition(t.formType)?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"请选择范围"},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"formItem.condition"}},e._l(e.calConditionOptions(t.formType,t),function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:function(i){e.typeOptionsChange(t)}},model:{value:t.typeId,callback:function(i){e.$set(t,"typeId",i)},expression:"formItem.typeId"}},e._l(t.typeOption,function(e){return i("el-option",{key:e.typeId,attrs:{label:e.name,value:e.typeId}})}))],1):e._e(),e._v(" "),i("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:"datetime"===t.formType||"date"===t.formType||"map_address"===t.formType?13:8}},["select"===t.formType?i("el-select",{attrs:{placeholder:"请选择筛选条件"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})):"checkStatus"===t.formType?i("el-select",{attrs:{placeholder:"请选择筛选条件"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})):"date"===t.formType||"datetime"===t.formType?i("el-date-picker",{staticStyle:{padding:"0px 10px"},attrs:{"value-format":"date"===t.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",type:"date"===t.formType?"daterange":"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}}):"business_type"===t.formType?i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.statusId,callback:function(i){e.$set(t,"statusId",i)},expression:"formItem.statusId"}},e._l(t.statusOption,function(e){return i("el-option",{key:e.statusId,attrs:{label:e.name,value:e.statusId}})})):"user"===t.formType?i("xh-user-cell",{attrs:{item:t,infoParams:{m:"crm",c:e.crmType,a:"index"}},on:{"value-change":e.arrayValueChange}}):"category"===t.formType?i("xh-prouct-cate",{attrs:{item:t},on:{"value-change":e.arrayValueChange}}):"map_address"===t.formType?i("v-distpicker",{attrs:{province:t.address.state,city:t.address.city,area:t.address.area},on:{province:function(i){e.selectProvince(i,t)},city:function(i){e.selectCity(i,t)},area:function(i){e.selectArea(i,t)}}}):i("el-input",{attrs:{placeholder:"请输入筛选条件"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}})],1),e._v(" "),i("el-col",{staticClass:"delete",attrs:{span:1}},[i("i",{staticClass:"el-icon-error delete-btn",on:{click:function(t){e.handleDelete(a)}}})])],1)]})],2)],1),e._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[i("span",{staticClass:"desc"},[e._v("筛选条件中有重复项！")])]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ 添加筛选条件")]),e._v(" "),e.isSeas?e._e():i("div",{staticClass:"save"},[i("el-checkbox",{model:{value:e.saveChecked,callback:function(t){e.saveChecked=t},expression:"saveChecked"}},[e._v("保存为场景")]),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"name",attrs:{maxlength:10,placeholder:"请输入场景名称，最多10个字符"},model:{value:e.saveName,callback:function(t){e.saveName="string"==typeof t?t.trim():t},expression:"saveName"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"save-setting"},[i("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("设置为默认")])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)},[],!1,null,"fdfb3858",null);r.options.__file="index.vue";t.a=r.exports},ozG6:function(e,t,i){},pITi:function(e,t,i){},ppJE:function(e,t,i){"use strict";var a=i("vG5h"),s=i("Ew9n"),n=i("F03V"),l=i("UEWd"),o=i("QJC7"),c=i("8KPp"),r=i("gd5k"),d=i("aQg/"),u=i("y9lt"),m=(i("7Qib"),i("i68b")),h={name:"customer-follow",components:{MixAdd:l.a,RecordLog:o.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},mixins:[m.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},watch:{id:function(e){}},data:function(){return{sendLoading:!1,nextTime:"",isEvent:!1,logType:"record",logTypes:[{type:"record",name:"跟进记录"},{type:"log",name:"日志"},{type:"examine",name:"审批"},{type:"task",name:"任务"},{type:"schedule",name:"日程"}],recordList:[]}},computed:{componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(e){this.followType=e},logTabsClick:function(e,t){this.logType=e.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(e){var t=this;if(!this.isEvent||this.nextTime)if(e.content){var i={};i.typesId=this.id,i.content=e.content,i.category=this.followType;var s=e.business.map(function(e,t,i){return e.businessId}),n=e.contacts.map(function(e,t,i){return e.contactsId});i.batchId=e.batchId,i.businessIds=s.join(","),i.contactsIds=n.join(","),i.isEvent=this.isEvent?1:0,i.nextTime=this.nextTime||"",this.sendLoading=!0,Object(a.v)(i).then(function(e){t.sendLoading=!1,t.$message.success("发布成功"),t.$refs.mixadd.resetInfo(),t.isEvent=!1,t.nextTime="",t.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){t.sendLoading=!1})}else this.$message.error("请输入跟进内容");else this.$message.error("请选择下次联系时间")}}},p=(i("HA6S"),i("ZrdR")),f=Object(p.a)(h,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"f-container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{crmType:e.crmType,id:e.id,"show-relative-business":!0,"show-relative-contacts":!0},on:{"mixadd-info":e.submitInfo}}),e._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[e._v("记录类型")]),e._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:e.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[e._v(e._s(e.followType?e.followType:"请选择"))]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.followTypes,function(t,a){return i("el-dropdown-item",{key:a,attrs:{command:t.type}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("div",{staticClass:"se-name"},[e._v("下次联系时间")]),e._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{type:"datetime",placeholder:"选择日期","default-value":new Date,"value-format":"yyyy-MM-dd HH:mm:ss",editable:!1},model:{value:e.nextTime,callback:function(t){e.nextTime=t},expression:"nextTime"}}),e._v(" "),i("el-checkbox",{model:{value:e.isEvent,callback:function(t){e.isEvent=t},expression:"isEvent"}},[e._v("添加到日程提醒")]),e._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(t){return e.sendInfo(t)}}},[e._v("发布")])],1)],1),e._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},e._l(e.logTypes,function(t,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){e.logTabsClick(t,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:e.logType==t.type?"#F18C70":"#777"}},[e._v(e._s(t.name))]),e._v(" "),e.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):e._e()])})),e._v(" "),i("keep-alive",[i(e.componentsName,{tag:"component",attrs:{id:e.id,crmType:e.crmType}})],1)],1)])},[],!1,null,"f4afee5a",null);f.options.__file="CustomerFollow.vue";var v=f.exports,g=i("U05J"),b=i("/U9q"),y=i("5j45"),w=i("cYid"),C=i("+NTD"),_=i("C+sD"),I=i("8DbX"),T=i("DUlf"),k=i("EgJF"),x=(i("a/LZ"),i("4+0Q")),D={name:"customer-detail",components:{SlideView:s.a,CustomerFollow:v,CRMDetailHead:n.a,CRMBaseInfo:g.a,RelativeContacts:b.a,RelativeBusiness:y.a,RelativeContract:w.a,RelativeReturnMoney:C.a,RelativeFiles:_.a,RelativeHandle:I.a,RelativeTeam:T.a,CRMCreateView:k.default},mixins:[x.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"customer",detailData:{},headDetails:[{title:"客户级别",value:""},{title:"成交状态",value:""},{title:"负责人",value:""},{title:"更新时间",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"customer-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"contacts"==this.tabCurrentName?"relative-contacts":"team"==this.tabCurrentName?"relative-team":"business"==this.tabCurrentName?"relative-business":"contract"==this.tabCurrentName?"relative-contract":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""},tabnames:function(){var e=[];return e.push({label:"跟进记录",name:"followlog"}),this.crm.customer&&this.crm.customer.read&&e.push({label:"基本信息",name:"basicinfo"}),this.crm.contacts&&this.crm.contacts.index&&e.push({label:"联系人",name:"contacts"}),e.push({label:"相关团队",name:"team"}),this.crm.business&&this.crm.business.index&&e.push({label:"商机",name:"business"}),this.crm.contract&&this.crm.contract.index&&e.push({label:"合同",name:"contract"}),this.crm.receivables&&this.crm.receivables.index&&e.push({label:"回款信息",name:"returnedmoney"}),e.push({label:"附件",name:"file"}),e.push({label:"操作记录",name:"operationlog"}),e},isSeasDetail:function(){return this.detailData&&this.detailData.hasOwnProperty("isPool")?1==this.detailData.isPool:this.isSeas}},mounted:function(){},methods:{getDetial:function(){var e=this;this.loading=!0,Object(a.s)({customerId:this.id}).then(function(t){e.loading=!1,e.detailData=t.data,e.headDetails[0].value=t.data.客户级别,e.headDetails[1].value=t.data.dealStatus,e.headDetails[2].value=t.data.ownerUserName,e.headDetails[3].value=t.data.updateTime}).catch(function(){e.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(e,t){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},L=(i("WTqp"),Object(p.a)(D,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!e.canShowDetail,expression:"!canShowDetail"}],attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",listenerIDs:e.listenerIDs,noListenerIDs:e.noListenerIDs,noListenerClass:e.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":e.hideView}},[e.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{crmType:"customer",isSeas:e.isSeasDetail,detail:e.detailData,headDetails:e.headDetails,id:e.id},on:{handle:e.detailHeadHandle,close:e.hideView}}),e._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.tabCurrentName,callback:function(t){e.tabCurrentName=t},expression:"tabCurrentName"}},e._l(e.tabnames,function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))],1),e._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(e.tabName,{tag:"component",attrs:{crmType:"customer",detail:e.detailData,id:e.id,isSeas:e.isSeasDetail}})],1)],1)],1):e._e(),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":"customer",action:{type:"update",id:this.id,batchId:e.detailData.batchId}},on:{"save-success":e.editSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"3b18c447",null));L.options.__file="CustomerDetail.vue";t.a=L.exports},rl4O:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},t7d2:function(e,t,i){},tpVs:function(e,t,i){"use strict";var a=i("88LX");i.n(a).a},v84z:function(e,t,i){"use strict";var a=i("TOIK");i.n(a).a},vPra:function(e,t,i){"use strict";i.d(t,"c",function(){return s}),i.d(t,"a",function(){return n}),i.d(t,"b",function(){return l});var a=i("t3Un");function s(e){return Object(a.a)({url:"comment/setComment",method:"post",data:e})}function n(e){return Object(a.a)({url:"comment/deleteComment",method:"post",data:e})}function l(e){return Object(a.a)({url:"comment/queryCommentList",method:"post",data:e})}},w5xH:function(e,t,i){"use strict";var a=i("03NE");i.n(a).a},woiz:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},xQxM:function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),s=i.n(a),n=i("2qvR"),l=i("KzkL"),o=i("5tgW"),c=i("vG5h"),r=i("/umX"),d=i.n(r),u=i("EPZ6"),m=i.n(u),h=i("QHZi"),p=d()({components:{},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-300,list:[],fieldList:[],currentPage:1,pageSize:15,pageSizes:[15,30,45,60],total:0}},mounted:function(){var e=this;this.$bus.on("message-scroll",function(t){e.tableHeight=t}),window.onresize=function(){e.updateTableHeight()}},beforeDestroy:function(){this.$bus.off("message-scroll")},methods:{handleRowClick:function(e,t,i){"leads"===this.crmType?(this.rowID=e.leadsId,this.rowType="leads",this.showDview=!0):"customer"===this.crmType?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):"contacts"===this.crmType?("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer"):(this.rowID=e.contactsId,this.rowType="contacts"),this.showDview=!0):"business"===this.crmType?("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer"):(this.rowID=e.businessId,this.rowType="business"),this.showDview=!0):"contract"===this.crmType?("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer"):"businessName"===t.property?(this.rowID=e.businessId,this.rowType="business"):"contactsName"===t.property?(this.rowID=e.contactsId,this.rowType="contacts"):(this.rowID=e.contractId,this.rowType="contract"),this.showDview=!0):"product"===this.crmType?(this.rowID=e.productId,this.showDview=!0):"receivables"===this.crmType?("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer"):"contractNum"===t.property||"contractName"===t.property?(this.rowID=e.contractId,this.rowType="contract"):(this.rowID=e.receivablesId,this.rowType="receivables"),this.showDview=!0):"receivables_plan"===this.crmType&&("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer"):"contractNum"!==t.property&&"contractName"!==t.property||(this.rowID=e.contractId,this.rowType="contract"),this.showDview=!0)},getList:function(){var e=this;this.loading=!0;var t=this.getIndexRequest(),i={page:this.currentPage,limit:this.pageSize,type:this.optionsType,isSub:this.isSubType},a=this.filterObj.obj;a&&m()(a).length>0&&(i.data=a),t(i).then(function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1}).catch(function(){e.loading=!1})},getIndexRequest:function(){return{todayCustomer:h.h,followLeads:h.g,followCustomer:h.f,checkContract:h.d,checkReceivables:h.e,remindReceivablesPlan:h.c,endContract:h.a}[this.infoType]},getFieldList:function(){var e=this;if("receivables_plan"==this.crmType){return this.handelFieldList([{fieldName:"num",formType:"text",name:"期数"},{fieldName:"customerName",formType:"customerName",name:"客户名称"},{fieldName:"contractNum",formType:"contractNum",name:"合同编号"},{fieldName:"money",formType:"text",name:"计划回款金额"},{fieldName:"returnDate",formType:"text",name:"计划回款日期"},{fieldName:"returnType",formType:"text",name:"计划回款方式"},{fieldName:"remind",formType:"text",name:"提前几日提醒"},{fieldName:"remark",formType:"text",name:"备注"}]),void this.getList()}Object(l.x)({label:n.a[this.crmType]}).then(function(t){e.handelFieldList(t.data),e.getList()}).catch(function(){e.loading=!1})},handelFieldList:function(e){for(var t=0;t<e.length;t++){var i=e[t],a=0;a=i.width?i.width:i.name&&i.name.length<=6?15*i.name.length+45:140,this.fieldList.push({prop:i.fieldName,label:i.name,width:a})}},fieldFormatter:function(e,t){return e[t.property]||"--"},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getStatusStyle:function(e){return 0==e?{"border-color":"#E6A23C","background-color":"#FDF6EC",color:"#E6A23C"}:1==e?{"border-color":"#409EFF","background-color":"#ECF5FF",color:"#409EFF"}:2==e?{"border-color":"#67C23A","background-color":"#F0F9EB",color:"#67C23A"}:3==e?{"border-color":"#F56C6B","background-color":"#FEF0F0",color:"#F56C6B"}:4==e?{"background-color":"#FFFFFF"}:void 0},getStatusName:function(e){return 0==e?"待审核":1==e?"审核中":2==e?"通过":3==e?"拒绝":4==e?"撤回":""},updateTableHeight:function(){var e=document.documentElement.clientHeight,t=m()(this.filterObj).length>0?360:300;this.tableHeight=e-t}}},"beforeDestroy",function(){document.getElementById("crm-table")&&document.getElementById("crm-table").removeEventListener("click",function(e){e.stopPropagation()})}),f=i("oWS4"),v=i("NS7n"),g=i("JXju"),b={name:"c-r-m-message",components:{filterForm:f.a,filterContent:v.a,CRMAllDetail:g.a},mixins:[p],watch:{show:function(){this.initTableHead()}},props:{crmType:{type:String,default:""},infoType:{type:String,default:""},infoTitle:{type:String,default:""},infoTips:{type:String,default:""},show:Boolean},data:function(){return{optionsType:0,isSubType:1,showFilter:!1,filterFieldList:[],filterObj:{form:[]},selectionList:[],selectionButtonList:[{name:"已跟进",type:"follow",icon:i("aQEv")}],rowID:"",rowType:"",showDview:!1}},computed:{showSelection:function(){return"followLeads"==this.infoType||"followCustomer"==this.infoType},showFilterView:function(){return"receivables_plan"!=this.crmType},showCheckStatus:function(){return"contract"==this.crmType||"receivables"==this.crmType},options:function(){return"todayCustomer"==this.infoType?[{name:"今日需联系",value:1},{name:"已逾期",value:2},{name:"已联系",value:3}]:"followLeads"==this.infoType||"followCustomer"==this.infoType?[{name:"待跟进",value:1},{name:"已跟进",value:2}]:"checkContract"==this.infoType||"checkReceivables"==this.infoType?[{name:"待审核",value:1},{name:"已审核",value:2}]:"remindReceivablesPlan"==this.infoType?[{name:"待回款",value:1},{name:"已回款",value:2},{name:"已逾期",value:3}]:"endContract"==this.infoType?[{name:"即将到期",value:1},{name:"已到期",value:2}]:[]}},mounted:function(){this.options.length>0&&(this.optionsType=this.options[0].value),this.initTableHead()},methods:{initTableHead:function(){this.show&&0==this.fieldList.length&&this.getFieldList()},refreshList:function(){this.currentPage=1,this.fieldList.length>0?this.getList():this.getFieldList()},handleSelectionChange:function(e){this.selectionList=e},selectionBarClick:function(e){var t=this;"follow"==e&&this.$confirm("您确定此操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(0,{followLeads:o.l,followCustomer:c.x}[t.infoType])({ids:t.selectionList.map(function(e){return e[t.crmType+"Id"]}).join(",")}).then(function(e){t.$message.success("操作成功"),t.refreshList(),t.$emit("on-handle",{type:"follow",value:t.selectionList.length,infoType:t.infoType})}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},getFilterFieldInfo:function(){var e=this;Object(l.z)({label:n.a[this.crmType]}).then(function(t){e.filterFieldList=t.data,e.showFilter=!0}).catch(function(){})},handleFilter:function(e){this.filterObj=e,this.showFilter=!1,this.updateTableHeight(),this.refreshList()},handleDeleteField:function(e){this.filterObj=e.obj,this.updateTableHeight(),this.refreshList()},cellStyle:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return"name"===t.property||"number"===t.property||"leadsName"===t.property||"customerName"===t.property||"businessName"===t.property||"contactsName"===t.property||"contractName"===t.property||"contractNum"===t.property?{color:"#3E84E9",cursor:"pointer"}:""}}},y=(i("6MGQ"),i("ZrdR")),w=Object(y.a)(b,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ec-container"},[a("div",{staticClass:"title"},[e._v(e._s(e.infoTitle)+"\n    "),e.infoTips?a("el-tooltip",{attrs:{effect:"dark",content:e.infoTips,placement:"top"}},[a("i",{staticClass:"wukong wukong-help_tips"}),e._v(">\n    ")]):e._e()],1),e._v(" "),a("div",{staticClass:"option-bar"},[0==e.selectionList.length?a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.refreshList},model:{value:e.optionsType,callback:function(t){e.optionsType=t},expression:"optionsType"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{placeholder:"请选择"},on:{change:e.refreshList},model:{value:e.isSubType,callback:function(t){e.isSubType=t},expression:"isSubType"}},e._l([{name:"我的",value:1},{name:"我下属的",value:2}],function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),e._v(" "),e.showFilterView?a("div",{staticClass:"filtrate-button",on:{click:e.getFilterFieldInfo}},[a("img",{staticClass:"filtrate-button-img",attrs:{src:i("3gs7")}}),e._v(" "),a("span",{staticClass:"filtrate-button-title"},[e._v("高级筛选")])]):e._e(),e._v(" "),a("filter-form",{attrs:{fieldList:e.filterFieldList,dialogVisible:e.showFilter,obj:e.filterObj,crmType:e.crmType,isSeas:!0},on:{"update:dialogVisible":function(t){e.showFilter=t},filter:e.handleFilter}})],1):a("flexbox",{staticClass:"selection-bar"},[a("div",{staticClass:"selected—title"},[e._v("已选中"),a("span",{staticClass:"selected—count"},[e._v(e._s(e.selectionList.length))]),e._v("项")]),e._v(" "),a("flexbox",{staticClass:"selection-items-box"},e._l(e.selectionButtonList,function(t,i){return a("flexbox",{key:i,staticClass:"selection-item",nativeOn:{click:function(i){e.selectionBarClick(t.type)}}},[a("img",{staticClass:"selection-item-icon",attrs:{src:t.icon}}),e._v(" "),a("div",{staticClass:"selection-item-name"},[e._v(e._s(t.name))])])}))],1)],1),e._v(" "),e.filterObj.form&&e.filterObj.form.length>0?a("filter-content",{attrs:{obj:e.filterObj},on:{delete:e.handleDeleteField}}):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border",staticStyle:{width:"100%"},attrs:{id:"crm-table",data:e.list,height:e.tableHeight,stripe:"",border:"","highlight-current-row":"","cell-style":e.cellStyle},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[e.showSelection?a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(t,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label,width:t.width,formatter:e.fieldFormatter}})}),e._v(" "),a("el-table-column",{attrs:{resizable:!1}}),e._v(" "),e.showCheckStatus?a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"checkStatus",label:"状态",resizable:!1,width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("div",{staticClass:"table-head-name"},[e._v(e._s(t.column.label))])]}},{key:"default",fn:function(t){return[a("div",{staticClass:"status_button",style:e.getStatusStyle(t.row.checkStatus)},[e._v("\n          "+e._s(e.getStatusName(t.row.checkStatus))+"\n        ")])]}}])}):e._e()],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:pageSize":function(t){e.pageSize=t}}})],1),e._v(" "),a("c-r-m-all-detail",{attrs:{visible:e.showDview,crmType:e.rowType,id:e.rowID},on:{"update:visible":function(t){e.showDview=t}}})],1)},[],!1,null,"651a725a",null);w.options.__file="CRMMessage.vue";var C=w.exports,_=i("8t5x"),I=i("7Qib"),T={name:"message",components:{CRMMessage:C},watch:{messageNum:function(){this.refreshNum()}},data:function(){return{leftType:"todayCustomer",leftSides:[{name:"今日需联系客户",crmType:"customer",infoType:"todayCustomer",num:0,tips:"下次跟进时间为今日的客户",hidden:!1},{name:"分配给我的线索",crmType:"leads",infoType:"followLeads",num:0,tips:"转移之后未跟进的线索",hidden:!1},{name:"分配给我的客户",crmType:"customer",infoType:"followCustomer",num:0,tips:"转移、领取、分配之后未跟进的客户，默认显示自己负责的客户",hidden:!1},{name:"待审核合同",crmType:"contract",infoType:"checkContract",num:0,tips:"",hidden:!1},{name:"待审核回款",crmType:"receivables",infoType:"checkReceivables",num:0,tips:"",hidden:!1},{name:"待回款提醒",crmType:"receivables_plan",infoType:"remindReceivablesPlan",num:0,tips:"",hidden:!1},{name:"即将到期的合同",crmType:"contract",infoType:"endContract",num:0,tips:"根据“合同到期时间”及设置的“提前提醒天数”提醒",hidden:!1}]}},computed:s()({},Object(_.b)(["messageNum"])),mounted:function(){var e=this;this.refreshNum(),window.onresize=function(){var t=document.documentElement.clientHeight;e.$bus.emit("message-scroll",t-300)}},methods:{refreshNum:function(){for(var e=0;e<this.leftSides.length;e++){var t=this.leftSides[e];this.messageNum.hasOwnProperty(t.infoType)?(t.num=this.messageNum[t.infoType]||0,t.hidden=!1):t.hidden=!0}},messageHandle:function(e){if("follow"==e.type){var t=Object(I.i)(this.messageNum),i=parseInt(t[e.infoType])-e.value;t[e.infoType]=i>0?i:0,this.$store.commit("SET_MESSAGENUM",t)}},sideClick:function(e){this.leftType=e.infoType}}},k=(i("QWvp"),Object(y.a)(T,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"message-header"},[e._v("\n    待办事项\n  ")]),e._v(" "),i("div",{staticClass:"message-body"},[i("div",{staticClass:"message-content"},[i("div",{staticClass:"message-body-side"},e._l(e.leftSides,function(t,a){return t.hidden?e._e():i("div",{key:a,staticClass:"side-item",class:e.leftType==t.infoType?"side-item-select":"side-item-default",on:{click:function(i){e.sideClick(t)}}},[e._v("\n          "+e._s(t.name)+"\n          "),t.num>0?i("el-badge",{attrs:{max:99,value:t.num}}):e._e()],1)})),e._v(" "),i("div",{staticClass:"message-body-content"},e._l(e.leftSides,function(t,a){return i("c-r-m-message",{directives:[{name:"show",rawName:"v-show",value:e.leftType==t.infoType,expression:"leftType==item.infoType"}],key:a,attrs:{crmType:t.crmType,infoType:t.infoType,infoTitle:t.name,infoTips:t.tips,show:e.leftType==t.infoType},on:{"on-handle":e.messageHandle}})}))])])])},[],!1,null,"10a532d0",null));k.options.__file="Message.vue";t.default=k.exports},y9lt:function(e,t,i){"use strict";var a=i("rerW"),s=i.n(a),n=i("KzkL"),l={name:"follow-schedule-cell",components:{},props:{data:Object},data:function(){return{}},filters:{getRemindtypeText:function(e){switch(e){case 0:return"无";case 1:return"准时提醒";case 2:return"5分钟前";case 3:return"15分钟前";case 4:return"30分钟前";case 5:return"一个小时前";case 6:return"二个小时前";case 7:return"一天前";case 8:return"二天前";case 9:return"一周前"}return""}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})}}},o=(i("3JdR"),i("ZrdR")),c=Object(o.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),e._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),a("div",{staticClass:"fl-h-time"},[e._v(e._s(e.data.createTime))])]),e._v(" "),!e.data.permission||1!=e.data.permission.isUpdate&&1!=e.data.permission.isDelete?e._e():a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission&&1==e.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]):e._e(),e._v(" "),e.data.permission&&1==e.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")]):e._e()],1)],1)],1),e._v(" "),a("div",{staticClass:"fl-b"},[a("div",[a("div",{staticClass:"state-color",style:{"background-color":e.data.color?e.data.color:"#fff"}}),e._v(e._s(e.data.title)+"\n    ")]),e._v(" "),a("div",{staticClass:"fl-b-des"},[a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("参与人：")]),e._v(" "),a("div",{staticClass:"owner-list"},e._l(e.data.ownerList,function(t,i){return a("span",{key:i},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[e._v(e._s(t.realname))])]),e._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:t,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(t.img),expression:"$options.filters.filterUserLazyImg(k.img)",arg:"background-image"}],key:t.img,staticClass:"div-photo header-circle"})])],1)}))]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("开始时间：")]),e._v(" "),a("div",[e._v(e._s(e.data.startTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("结束时间：")]),e._v(" "),a("div",[e._v(e._s(e.data.endTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("备注：")]),e._v(" "),a("div",[e._v(e._s(e.data.remark))])])],1),e._v(" "),e.data.contactsList.length>0||e.data.customerList.length>0||e.data.businessList.length>0||e.data.contractList.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[e._v("关联业务")]),e._v(" "),e._l(e.data.contactsList,function(t,s){return a("p",{key:"contacts"+s,on:{click:function(i){e.checkRelatedDetail("contacts",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        联系人-"+e._s(t.name)+"\n      ")])}),e._v(" "),e._l(e.data.customerList,function(t,s){return a("p",{key:"customer"+s,on:{click:function(i){e.checkRelatedDetail("customer",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        客户-"+e._s(t.customerName)+"\n      ")])}),e._v(" "),e._l(e.data.businessList,function(t,s){return a("p",{key:"business"+s,on:{click:function(i){e.checkRelatedDetail("business",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        商机-"+e._s(t.businessName)+"\n      ")])}),e._v(" "),e._l(e.data.contractList,function(t,s){return a("p",{key:"contract"+s,on:{click:function(i){e.checkRelatedDetail("contract",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        合同-"+e._s(t.name)+"\n      ")])})],2):e._e()])],1)},[],!1,null,"6f1401b3",null);c.options.__file="FollowScheduleCell.vue";var r=c.exports,d=i("Dh/N"),u=i("BuGm"),m=(i("7Qib"),{name:"schedule-log",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-4707"),i.e("chunk-fc80"),i.e("chunk-7b3a")]).then(i.bind(null,"uMjE"))},CreateSchedule:u.default},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(n.i)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(e){var t=this;if("edit"==e.type){this.newText="编辑日程";var i=e.data.item;i.startTime=i.startTime,i.endTime=i.endTime,i.ownerUserIds=[];var a=!0,n=!1,l=void 0;try{for(var o,c=s()(i.ownerList);!(a=(o=c.next()).done);a=!0){var r=o.value;i.ownerUserIds.push(r.userId)}}catch(e){n=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(n)throw l}}this.formData=i,this.showDialog=!0}else"delete"==e.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({eventId:e.data.item.eventId}).then(function(e){t.refreshList(),t.$message({type:"success",message:"删除成功!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):"related-detail"==e.type&&(this.rowID=e.data.item[e.data.type+"Id"],this.detailCRMType=e.data.type,this.showFullDetail=!0)},onSubmit:function(e,t){this.refreshList(),"创建日程"==this.newText?(this.$message.success("新建成功"),this.showDialog=!1):(this.$message.success("编辑成功"),this.showDialog=!1)}}}),h=(i("S3eq"),Object(o.a)(m,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("follow-schedule-cell",{key:a,attrs:{data:t},on:{"on-handle":e.examineCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.showDialog?i("create-schedule",{attrs:{text:e.newText,formData:e.formData,appendToBody:!0},on:{onSubmit:e.onSubmit,closeDialog:function(t){e.showDialog=!1}}}):e._e()],1)},[],!1,null,"852a3a10",null));h.options.__file="ScheduleLog.vue";t.a=h.exports}}]);